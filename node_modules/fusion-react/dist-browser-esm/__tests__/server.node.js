/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 * 
 */
import * as React from 'react';
import { getSimulator } from 'fusion-test-utils';
import render from '../server';
import App from '../index';
test('renders', () => {
  const rendered = render(React.createElement('span', null, 'hello'));
  expect(/<span/.test(rendered)).toBeTruthy();
  expect(/hello/.test(rendered)).toBeTruthy();
});
test('app api', async done => {
  expect(typeof App).toBe('function');

  try {
    const app = new App(React.createElement('div', null, 'Hello World'));
    const simulator = getSimulator(app);
    const ctx = await simulator.render('/');
    expect(ctx.rendered.includes('Hello World')).toBeTruthy();
    expect(typeof ctx.body === 'string' && ctx.body.includes(ctx.rendered)).toBeTruthy();
  } catch (e) {
    expect(e).toBeFalsy();
  } finally {
    done();
  }
});
test('throw on non-element root', async () => {
  expect(() => {
    // $FlowFixMe
    new App(function () {
      return null;
    });
  }).toThrow();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5ub2RlLmpzIl0sIm5hbWVzIjpbIlJlYWN0IiwiZ2V0U2ltdWxhdG9yIiwicmVuZGVyIiwiQXBwIiwidGVzdCIsInJlbmRlcmVkIiwiY3JlYXRlRWxlbWVudCIsImV4cGVjdCIsInRvQmVUcnV0aHkiLCJkb25lIiwidG9CZSIsImFwcCIsInNpbXVsYXRvciIsImN0eCIsImluY2x1ZGVzIiwiYm9keSIsImUiLCJ0b0JlRmFsc3kiLCJ0b1Rocm93Il0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQVFBLE9BQU8sS0FBS0EsS0FBWixNQUF1QixPQUF2QjtBQUNBLFNBQVFDLFlBQVIsUUFBMkIsbUJBQTNCO0FBQ0EsT0FBT0MsTUFBUCxNQUFtQixXQUFuQjtBQUNBLE9BQU9DLEdBQVAsTUFBZ0IsVUFBaEI7QUFFQUMsSUFBSSxDQUFDLFNBQUQsRUFBWSxNQUFNO0FBQ3BCLFFBQU1DLFFBQVEsR0FBR0gsTUFBTSxDQUFDRixLQUFLLENBQUNNLGFBQU4sQ0FBb0IsTUFBcEIsRUFBNEIsSUFBNUIsRUFBa0MsT0FBbEMsQ0FBRCxDQUF2QjtBQUNBQyxFQUFBQSxNQUFNLENBQUMsUUFBUUgsSUFBUixDQUFhQyxRQUFiLENBQUQsQ0FBTixDQUErQkcsVUFBL0I7QUFDQUQsRUFBQUEsTUFBTSxDQUFDLFFBQVFILElBQVIsQ0FBYUMsUUFBYixDQUFELENBQU4sQ0FBK0JHLFVBQS9CO0FBQ0QsQ0FKRyxDQUFKO0FBTUFKLElBQUksQ0FBQyxTQUFELEVBQVksTUFBTUssSUFBTixJQUFjO0FBQzVCRixFQUFBQSxNQUFNLENBQUMsT0FBT0osR0FBUixDQUFOLENBQW1CTyxJQUFuQixDQUF3QixVQUF4Qjs7QUFDQSxNQUFJO0FBQ0YsVUFBTUMsR0FBRyxHQUFHLElBQUlSLEdBQUosQ0FBUUgsS0FBSyxDQUFDTSxhQUFOLENBQW9CLEtBQXBCLEVBQTJCLElBQTNCLEVBQWlDLGFBQWpDLENBQVIsQ0FBWjtBQUNBLFVBQU1NLFNBQVMsR0FBR1gsWUFBWSxDQUFDVSxHQUFELENBQTlCO0FBQ0EsVUFBTUUsR0FBRyxHQUFHLE1BQU1ELFNBQVMsQ0FBQ1YsTUFBVixDQUFpQixHQUFqQixDQUFsQjtBQUNBSyxJQUFBQSxNQUFNLENBQUNNLEdBQUcsQ0FBQ1IsUUFBSixDQUFhUyxRQUFiLENBQXNCLGFBQXRCLENBQUQsQ0FBTixDQUE2Q04sVUFBN0M7QUFDQUQsSUFBQUEsTUFBTSxDQUNKLE9BQU9NLEdBQUcsQ0FBQ0UsSUFBWCxLQUFvQixRQUFwQixJQUFnQ0YsR0FBRyxDQUFDRSxJQUFKLENBQVNELFFBQVQsQ0FBa0JELEdBQUcsQ0FBQ1IsUUFBdEIsQ0FENUIsQ0FBTixDQUVFRyxVQUZGO0FBR0QsR0FSRCxDQVFFLE9BQU9RLENBQVAsRUFBVTtBQUNWVCxJQUFBQSxNQUFNLENBQUNTLENBQUQsQ0FBTixDQUFVQyxTQUFWO0FBQ0QsR0FWRCxTQVVVO0FBQ1JSLElBQUFBLElBQUk7QUFDTDtBQUNGLENBZkcsQ0FBSjtBQWlCQUwsSUFBSSxDQUFDLDJCQUFELEVBQThCLFlBQVk7QUFDNUNHLEVBQUFBLE1BQU0sQ0FBQyxNQUFNO0FBQ1g7QUFDQSxRQUFJSixHQUFKLENBQVEsWUFBVztBQUNqQixhQUFPLElBQVA7QUFDRCxLQUZEO0FBR0QsR0FMSyxDQUFOLENBS0dlLE9BTEg7QUFNRCxDQVBHLENBQUoiLCJzb3VyY2VzQ29udGVudCI6WyIvKiogQ29weXJpZ2h0IChjKSAyMDE4IFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZsb3dcbiAqL1xuXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge2dldFNpbXVsYXRvcn0gZnJvbSAnZnVzaW9uLXRlc3QtdXRpbHMnO1xuaW1wb3J0IHJlbmRlciBmcm9tICcuLi9zZXJ2ZXInO1xuaW1wb3J0IEFwcCBmcm9tICcuLi9pbmRleCc7XG5cbnRlc3QoJ3JlbmRlcnMnLCAoKSA9PiB7XG4gIGNvbnN0IHJlbmRlcmVkID0gcmVuZGVyKFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCBudWxsLCAnaGVsbG8nKSk7XG4gIGV4cGVjdCgvPHNwYW4vLnRlc3QocmVuZGVyZWQpKS50b0JlVHJ1dGh5KCk7XG4gIGV4cGVjdCgvaGVsbG8vLnRlc3QocmVuZGVyZWQpKS50b0JlVHJ1dGh5KCk7XG59KTtcblxudGVzdCgnYXBwIGFwaScsIGFzeW5jIGRvbmUgPT4ge1xuICBleHBlY3QodHlwZW9mIEFwcCkudG9CZSgnZnVuY3Rpb24nKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIG51bGwsICdIZWxsbyBXb3JsZCcpKTtcbiAgICBjb25zdCBzaW11bGF0b3IgPSBnZXRTaW11bGF0b3IoYXBwKTtcbiAgICBjb25zdCBjdHggPSBhd2FpdCBzaW11bGF0b3IucmVuZGVyKCcvJyk7XG4gICAgZXhwZWN0KGN0eC5yZW5kZXJlZC5pbmNsdWRlcygnSGVsbG8gV29ybGQnKSkudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChcbiAgICAgIHR5cGVvZiBjdHguYm9keSA9PT0gJ3N0cmluZycgJiYgY3R4LmJvZHkuaW5jbHVkZXMoY3R4LnJlbmRlcmVkKVxuICAgICkudG9CZVRydXRoeSgpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgZXhwZWN0KGUpLnRvQmVGYWxzeSgpO1xuICB9IGZpbmFsbHkge1xuICAgIGRvbmUoKTtcbiAgfVxufSk7XG5cbnRlc3QoJ3Rocm93IG9uIG5vbi1lbGVtZW50IHJvb3QnLCBhc3luYyAoKSA9PiB7XG4gIGV4cGVjdCgoKSA9PiB7XG4gICAgLy8gJEZsb3dGaXhNZVxuICAgIG5ldyBBcHAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9KTtcbiAgfSkudG9UaHJvdygpO1xufSk7XG4iXX0=
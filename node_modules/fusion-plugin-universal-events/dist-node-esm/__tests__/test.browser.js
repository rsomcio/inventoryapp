/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

/* eslint-env browser */

import 'whatwg-fetch'; // Needed for Response global

import App from 'fusion-core';
import { FetchToken } from 'fusion-tokens';
import { getSimulator } from 'fusion-test-utils';
import plugin, { UniversalEmitter } from '../browser';
import { UniversalEventsToken } from '../index';
import { UniversalEventsBatchStorageToken, inMemoryBatchStorage as store } from '../storage/index';

// Set document.visibilityState to test flushBeforeTerminated
Object.defineProperty(document, 'visibilityState', {
  value: 'hidden'
});
const visibilitychangeEvent = new Event('visibilitychange');

/* Test helpers */
function getApp(fetch) {
  const app = new App('el', el => el);
  app.register(FetchToken, fetch);
  store.getAndClear();
  app.register(UniversalEventsBatchStorageToken, store);
  app.register(UniversalEventsToken, plugin);
  return app;
}
function createMockFetch(responseParams) {
  const mockResponse = new Response();
  // $FlowFixMe
  return {
    ...mockResponse,
    ...responseParams
  };
}
test('Browser EventEmitter', async () => {
  let fetched = false;
  let emitted = false;
  navigator.sendBeacon = jest.fn((url, payload) => {
    if (!payload) {
      throw new Error(`Expected payload to exist`);
    }
    expect(url).toBe('/_events');
    const jsonBody = JSON.parse(payload.toString());
    expect(jsonBody.items.length).toBe(1);
    expect(jsonBody.items[0].payload.x).toBe(1);
    fetched = true;
    return true;
  });
  const fetch = jest.fn();
  const app = getApp(fetch);
  app.middleware({
    events: UniversalEventsToken
  }, ({
    events
  }) => {
    return (ctx, next) => {
      const emitter = events.from(ctx);
      expect(emitter).toBe(events);
      emitter.on('a', ({
        x
      }) => {
        expect(x).toBe(1);
        emitted = true;
      });
      emitter.emit('a', {
        x: 1
      });
      window.dispatchEvent(visibilitychangeEvent);
      emitter.teardown();
      return next();
    };
  });
  const simulator = getSimulator(app);
  await simulator.render('/');
  expect(navigator.sendBeacon).toHaveBeenCalled();
  expect(fetch).not.toHaveBeenCalled();
  expect(emitted).toBe(true);
  expect(fetched).toBe(true);
  expect(store.data.length).toBe(0);
});
test('Browser EventEmitter should append routePrefix if sendBeacon API is used', async () => {
  window.__ROUTE_PREFIX__ = '/routePrefix';
  navigator.sendBeacon = jest.fn((url, payload) => {
    expect(url).toBe('/routePrefix/_events');
    return true;
  });
  const fetch = jest.fn();
  const app = getApp(fetch);
  app.middleware({
    events: UniversalEventsToken
  }, ({
    events
  }) => {
    return (ctx, next) => {
      const emitter = events.from(ctx);
      expect(emitter).toBe(events);
      emitter.emit('a', {
        x: 1
      });
      window.dispatchEvent(visibilitychangeEvent);
      emitter.teardown();
      return next();
    };
  });
  const simulator = getSimulator(app);
  await simulator.render('/');
  delete window.__ROUTE_PREFIX__;
});
test('Browser EventEmitter should not routePrefix if fetch API is used since it is appended in csrf plugin', async () => {
  window.__ROUTE_PREFIX__ = '/routePrefix';
  navigator.sendBeacon = undefined;
  const fetch = jest.fn();
  const app = getApp(fetch);
  app.middleware({
    events: UniversalEventsToken
  }, ({
    events
  }) => {
    return (ctx, next) => {
      const emitter = events.from(ctx);
      expect(emitter).toBe(events);
      emitter.emit('a', {
        x: 1
      });
      window.dispatchEvent(visibilitychangeEvent);
      emitter.teardown();
      return next();
    };
  });
  const simulator = getSimulator(app);
  await simulator.render('/');
  expect(fetch).toHaveBeenCalledWith('/_events', expect.anything());
  delete window.__ROUTE_PREFIX__;
});
test('Browser EventEmitter - should fall back to fetch if sendBeacon is not supported', async () => {
  let fetched = false;
  let emitted = false;
  navigator.sendBeacon = undefined;
  const fetch = jest.fn((url, options) => {
    if (!options || !options.method || !options.headers || !options.body || typeof options.body !== 'string') {
      throw new Error(`Expected method, headers, body from options are populated`);
    }
    let {
      method,
      headers,
      body
    } = options;
    expect(url).toBe('/_events');
    expect(method).toBe('POST');
    expect(
    // $FlowFixMe
    headers['Content-Type']).toBe('application/json');
    const jsonBody = JSON.parse(body);
    expect(jsonBody.items.length).toBe(1);
    expect(jsonBody.items[0].payload.x).toBe(1);
    fetched = true;
    return Promise.resolve(createMockFetch());
  });
  const app = getApp(fetch);
  app.middleware({
    events: UniversalEventsToken
  }, ({
    events
  }) => {
    return (ctx, next) => {
      const emitter = events.from(ctx);
      expect(emitter).toBe(events);
      emitter.on('a', ({
        x
      }) => {
        expect(x).toBe(1);
        emitted = true;
      });
      emitter.emit('a', {
        x: 1
      });
      window.dispatchEvent(visibilitychangeEvent);
      emitter.teardown();
      return next();
    };
  });
  const simulator = getSimulator(app);
  await simulator.render('/');
  expect(fetch).toHaveBeenCalled();
  expect(emitted).toBe(true);
  expect(fetched).toBe(true);
  expect(store.data.length).toBe(0);
});
test('Browser EventEmitter - should fall back to fetch if beacon fails to enqueue', async () => {
  navigator.sendBeacon = jest.fn(() => false);
  const fetch = jest.fn(() => Promise.resolve(createMockFetch({
    ok: true
  })));
  const app = getApp(fetch);
  app.middleware({
    events: UniversalEventsToken
  }, ({
    events
  }) => {
    return (ctx, next) => {
      const emitter = events.from(ctx);
      expect(emitter).toBe(events);
      emitter.emit('a', {
        x: 1
      });
      window.dispatchEvent(visibilitychangeEvent);
      emitter.teardown();
      return next();
    };
  });
  const simulator = getSimulator(app);
  await simulator.render('/');
  expect(navigator.sendBeacon).toHaveBeenCalled();
  expect(fetch).toHaveBeenCalled();
  expect(store.data.length).toBe(0);
});
test('Browser EventEmitter - should not send all the events if beacon is too big', async () => {
  navigator.sendBeacon = jest.fn(() => true);
  const fetch = jest.fn(() => Promise.resolve(createMockFetch()));
  const app = getApp(fetch);
  app.middleware({
    events: UniversalEventsToken
  }, ({
    events
  }) => {
    return (ctx, next) => {
      const emitter = events.from(ctx);
      expect(emitter).toBe(events);
      emitter.emit('a', {
        x: 'a'.repeat(40000)
      });
      emitter.emit('b', {
        x: 'b'.repeat(40000)
      });
      window.dispatchEvent(visibilitychangeEvent);
      emitter.teardown();
      return next();
    };
  });
  const simulator = getSimulator(app);
  await simulator.render('/');
  expect(navigator.sendBeacon).toHaveBeenCalled();
  expect(store.data.length).toBe(1);
});
test('Browser EventEmitter - should use fetch if single event is larger than beacon limit', async () => {
  navigator.sendBeacon = jest.fn(() => true);
  const fetch = jest.fn(() => Promise.resolve(createMockFetch()));
  const app = getApp(fetch);
  app.middleware({
    events: UniversalEventsToken
  }, ({
    events
  }) => {
    return (ctx, next) => {
      const emitter = events.from(ctx);
      expect(emitter).toBe(events);
      emitter.emit('a', {
        x: 'a'.repeat(100000)
      });
      window.dispatchEvent(visibilitychangeEvent);
      emitter.teardown();
      return next();
    };
  });
  const simulator = getSimulator(app);
  await simulator.render('/');
  expect(fetch).toHaveBeenCalled();
  expect(store.data.length).toBe(0);
});
test('Browser EventEmitter - fetch adds events back to queue if they fail to send', async () => {
  navigator.sendBeacon = undefined;
  const fetch = () => Promise.resolve(createMockFetch({
    ok: false
  }));
  const app = getApp(fetch);
  app.middleware({
    events: UniversalEventsToken
  }, ({
    events
  }) => {
    return (ctx, next) => {
      const emitter = events.from(ctx);
      expect(emitter).toBe(events);
      emitter.emit('a', {
        x: 1
      });
      window.dispatchEvent(visibilitychangeEvent);
      emitter.teardown();
      return next();
    };
  });
  const simulator = getSimulator(app);
  await simulator.render('/');
  expect(store.data.length).toBe(1);
});
test('Browser EventEmitter - fetch adds events back to queue if they fail to send 2', async () => {
  navigator.sendBeacon = undefined;
  const fetch = () => Promise.reject();
  const app = getApp(fetch);
  app.middleware({
    events: UniversalEventsToken
  }, ({
    events
  }) => {
    return (ctx, next) => {
      const emitter = events.from(ctx);
      expect(emitter).toBe(events);
      emitter.emit('a', {
        x: 1
      });
      window.dispatchEvent(visibilitychangeEvent);
      emitter.teardown();
      return next();
    };
  });
  const simulator = getSimulator(app);
  await simulator.render('/');
  expect(store.data.length).toBe(1);
});
test('Browser EventEmitter interval', done => {
  navigator.sendBeacon = jest.fn(() => true);
  store.getAndClear();
  const emitter = new UniversalEmitter(() => {
    return Promise.resolve(createMockFetch());
  }, {
    add() {},
    addToStart() {},
    getAndClear() {
      expect('Calls storage getAndClear on interval').toBeTruthy();
      emitter.teardown();
      done();
      return [];
    }
  }, 1);
});
test('Respects the limit when flushing', async () => {
  navigator.sendBeacon = jest.fn(() => true);
  store.getAndClear();
  const fetch = () => Promise.resolve(createMockFetch());
  const emitter = new UniversalEmitter(fetch, store, 2000, 20);
  for (let index = 0; index < 50; index++) {
    emitter.emit('a', {
      x: 1
    });
  }
  await emitter.flush();
  expect(store.data.length).toBe(30);
  await emitter.flush();
  expect(store.data.length).toBe(10);
  await emitter.flush();
  expect(store.data.length).toBe(0);
  emitter.teardown();
});
test('Calling flush even no items works as expected', async () => {
  navigator.sendBeacon = jest.fn(() => true);
  store.getAndClear();
  const fetch = () => Promise.resolve(createMockFetch());
  const emitter = new UniversalEmitter(fetch, store, 100, 20);
  await emitter.flush();
  await emitter.flush();
  await new Promise(resolve => setTimeout(resolve, 3000));
  for (let index = 0; index < 20; index++) {
    emitter.emit('a', {
      x: 1
    });
  }
  await emitter.flush();
  expect(store.data.length).toBe(0);
  emitter.teardown();
});
test('Fetch lowers limit for 413 errors', async () => {
  navigator.sendBeacon = undefined;
  store.getAndClear();
  const fetch = () => Promise.resolve(createMockFetch({
    status: 413,
    ok: false
  }));
  const emitter = new UniversalEmitter(fetch, store, 2000, 20);
  emitter.emit('a', {
    x: 1
  });
  await emitter.flush();
  expect(store.data.length).toBe(1);
  expect(emitter.limit).toBe(10);
  await emitter.flush();
  expect(emitter.limit).toBe(5);
  await emitter.flush();
  emitter.teardown();
});
const sleep = ms => setTimeout(() => {}, ms);
test('Browser EventEmitter does not start a new flush while another one is in progress', async () => {
  navigator.sendBeacon = undefined;
  store.getAndClear();
  let resolveFetch = () => {};
  const fetch = jest.fn().mockReturnValue(new Promise(resolve => {
    resolveFetch = resolve;
  }));
  const emitter = new UniversalEmitter(fetch, store, 2000, 20);
  emitter.emit('a', {
    x: 1
  });
  emitter.flush();
  emitter.emit('b', {
    y: 1
  });
  emitter.flush();
  emitter.flush();
  // first request is not resolved, only one request at the moment
  expect(fetch).toBeCalledTimes(1);
  resolveFetch(createMockFetch());
  await sleep(1);
  // scheduled flush should be started after first request/flush is resolved
  expect(fetch).toBeCalledTimes(2);
  resolveFetch(createMockFetch());
  await sleep(1);
  // no more additional flush is needed as far as no events were emitted
  expect(fetch).toBeCalledTimes(2);
  emitter.teardown();
});
test('Browser EventEmitter - should not send payloads larger than xhr body limit', async () => {
  const fetch = jest.fn(() => Promise.resolve(createMockFetch()));
  const app = getApp(fetch);
  app.middleware({
    events: UniversalEventsToken
  }, ({
    events
  }) => {
    return (ctx, next) => {
      const emitter = events.from(ctx);
      expect(emitter).toBe(events);
      // emit 5 events that are each slighly under half the max payload limit
      emitter.emit('a', {
        x: 'a'.repeat(1048576 / 2 - 100)
      });
      emitter.emit('b', {
        x: 'b'.repeat(1048576 / 2 - 100)
      });
      emitter.emit('c', {
        x: 'c'.repeat(1048576 / 2 - 100)
      });
      emitter.emit('d', {
        x: 'e'.repeat(1048576 / 2 - 100)
      });
      emitter.emit('e', {
        x: 'e'.repeat(1048576 / 2 - 100)
      });
      window.dispatchEvent(visibilitychangeEvent);
      emitter.teardown();
      return next();
    };
  });
  const simulator = getSimulator(app);
  await simulator.render('/');
  expect(store.data.length).toBe(3);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcHAiLCJGZXRjaFRva2VuIiwiZ2V0U2ltdWxhdG9yIiwicGx1Z2luIiwiVW5pdmVyc2FsRW1pdHRlciIsIlVuaXZlcnNhbEV2ZW50c1Rva2VuIiwiVW5pdmVyc2FsRXZlbnRzQmF0Y2hTdG9yYWdlVG9rZW4iLCJpbk1lbW9yeUJhdGNoU3RvcmFnZSIsInN0b3JlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJkb2N1bWVudCIsInZhbHVlIiwidmlzaWJpbGl0eWNoYW5nZUV2ZW50IiwiRXZlbnQiLCJnZXRBcHAiLCJmZXRjaCIsImFwcCIsImVsIiwicmVnaXN0ZXIiLCJnZXRBbmRDbGVhciIsImNyZWF0ZU1vY2tGZXRjaCIsInJlc3BvbnNlUGFyYW1zIiwibW9ja1Jlc3BvbnNlIiwiUmVzcG9uc2UiLCJ0ZXN0IiwiZmV0Y2hlZCIsImVtaXR0ZWQiLCJuYXZpZ2F0b3IiLCJzZW5kQmVhY29uIiwiamVzdCIsImZuIiwidXJsIiwicGF5bG9hZCIsIkVycm9yIiwiZXhwZWN0IiwidG9CZSIsImpzb25Cb2R5IiwiSlNPTiIsInBhcnNlIiwidG9TdHJpbmciLCJpdGVtcyIsImxlbmd0aCIsIngiLCJtaWRkbGV3YXJlIiwiZXZlbnRzIiwiY3R4IiwibmV4dCIsImVtaXR0ZXIiLCJmcm9tIiwib24iLCJlbWl0Iiwid2luZG93IiwiZGlzcGF0Y2hFdmVudCIsInRlYXJkb3duIiwic2ltdWxhdG9yIiwicmVuZGVyIiwidG9IYXZlQmVlbkNhbGxlZCIsIm5vdCIsImRhdGEiLCJfX1JPVVRFX1BSRUZJWF9fIiwidW5kZWZpbmVkIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJhbnl0aGluZyIsIm9wdGlvbnMiLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIlByb21pc2UiLCJyZXNvbHZlIiwib2siLCJyZXBlYXQiLCJyZWplY3QiLCJkb25lIiwiYWRkIiwiYWRkVG9TdGFydCIsInRvQmVUcnV0aHkiLCJpbmRleCIsImZsdXNoIiwic2V0VGltZW91dCIsInN0YXR1cyIsImxpbWl0Iiwic2xlZXAiLCJtcyIsInJlc29sdmVGZXRjaCIsIm1vY2tSZXR1cm5WYWx1ZSIsInkiLCJ0b0JlQ2FsbGVkVGltZXMiXSwic291cmNlcyI6WyJzcmMvX190ZXN0c19fL3Rlc3QuYnJvd3Nlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiogQ29weXJpZ2h0IChjKSAyMDE4IFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICovXG5cbi8qIGVzbGludC1lbnYgYnJvd3NlciAqL1xuXG5pbXBvcnQgJ3doYXR3Zy1mZXRjaCc7IC8vIE5lZWRlZCBmb3IgUmVzcG9uc2UgZ2xvYmFsXG5cbmltcG9ydCBBcHAgZnJvbSAnZnVzaW9uLWNvcmUnO1xuaW1wb3J0IHtGZXRjaFRva2VufSBmcm9tICdmdXNpb24tdG9rZW5zJztcbmltcG9ydCB0eXBlIHtGZXRjaH0gZnJvbSAnZnVzaW9uLXRva2Vucyc7XG5pbXBvcnQge2dldFNpbXVsYXRvcn0gZnJvbSAnZnVzaW9uLXRlc3QtdXRpbHMnO1xuXG5pbXBvcnQgcGx1Z2luLCB7VW5pdmVyc2FsRW1pdHRlcn0gZnJvbSAnLi4vYnJvd3Nlcic7XG5pbXBvcnQge1VuaXZlcnNhbEV2ZW50c1Rva2VufSBmcm9tICcuLi9pbmRleCc7XG5pbXBvcnQge1xuICBVbml2ZXJzYWxFdmVudHNCYXRjaFN0b3JhZ2VUb2tlbixcbiAgaW5NZW1vcnlCYXRjaFN0b3JhZ2UgYXMgc3RvcmUsXG59IGZyb20gJy4uL3N0b3JhZ2UvaW5kZXgnO1xuXG4vLyBTZXQgZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlIHRvIHRlc3QgZmx1c2hCZWZvcmVUZXJtaW5hdGVkXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnQsICd2aXNpYmlsaXR5U3RhdGUnLCB7dmFsdWU6ICdoaWRkZW4nfSk7XG5jb25zdCB2aXNpYmlsaXR5Y2hhbmdlRXZlbnQgPSBuZXcgRXZlbnQoJ3Zpc2liaWxpdHljaGFuZ2UnKTtcblxuLyogVGVzdCBoZWxwZXJzICovXG5mdW5jdGlvbiBnZXRBcHAoZmV0Y2g6IEZldGNoKSB7XG4gIGNvbnN0IGFwcCA9IG5ldyBBcHAoJ2VsJywgKGVsKSA9PiBlbCk7XG4gIGFwcC5yZWdpc3RlcihGZXRjaFRva2VuLCBmZXRjaCk7XG4gIHN0b3JlLmdldEFuZENsZWFyKCk7XG4gIGFwcC5yZWdpc3RlcihVbml2ZXJzYWxFdmVudHNCYXRjaFN0b3JhZ2VUb2tlbiwgc3RvcmUpO1xuICBhcHAucmVnaXN0ZXIoVW5pdmVyc2FsRXZlbnRzVG9rZW4sIHBsdWdpbik7XG4gIHJldHVybiBhcHA7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZU1vY2tGZXRjaChyZXNwb25zZVBhcmFtcz86IGFueSk6IFJlc3BvbnNlIHtcbiAgY29uc3QgbW9ja1Jlc3BvbnNlID0gbmV3IFJlc3BvbnNlKCk7XG4gIC8vICRGbG93Rml4TWVcbiAgcmV0dXJuIHtcbiAgICAuLi5tb2NrUmVzcG9uc2UsXG4gICAgLi4ucmVzcG9uc2VQYXJhbXMsXG4gIH07XG59XG5cbnRlc3QoJ0Jyb3dzZXIgRXZlbnRFbWl0dGVyJywgYXN5bmMgKCkgPT4ge1xuICBsZXQgZmV0Y2hlZCA9IGZhbHNlO1xuICBsZXQgZW1pdHRlZCA9IGZhbHNlO1xuICBuYXZpZ2F0b3Iuc2VuZEJlYWNvbiA9IGplc3QuZm4oKHVybCwgcGF5bG9hZCkgPT4ge1xuICAgIGlmICghcGF5bG9hZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBwYXlsb2FkIHRvIGV4aXN0YCk7XG4gICAgfVxuXG4gICAgZXhwZWN0KHVybCkudG9CZSgnL19ldmVudHMnKTtcbiAgICBjb25zdCBqc29uQm9keSA9IEpTT04ucGFyc2UocGF5bG9hZC50b1N0cmluZygpKTtcbiAgICBleHBlY3QoanNvbkJvZHkuaXRlbXMubGVuZ3RoKS50b0JlKDEpO1xuICAgIGV4cGVjdChqc29uQm9keS5pdGVtc1swXS5wYXlsb2FkLngpLnRvQmUoMSk7XG4gICAgZmV0Y2hlZCA9IHRydWU7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0pO1xuICBjb25zdCBmZXRjaCA9IGplc3QuZm4oKTtcblxuICBjb25zdCBhcHAgPSBnZXRBcHAoZmV0Y2gpO1xuICBhcHAubWlkZGxld2FyZSh7ZXZlbnRzOiBVbml2ZXJzYWxFdmVudHNUb2tlbn0sICh7ZXZlbnRzfSkgPT4ge1xuICAgIHJldHVybiAoY3R4LCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCBlbWl0dGVyID0gZXZlbnRzLmZyb20oY3R4KTtcbiAgICAgIGV4cGVjdChlbWl0dGVyKS50b0JlKGV2ZW50cyk7XG4gICAgICBlbWl0dGVyLm9uKCdhJywgKHt4fSkgPT4ge1xuICAgICAgICBleHBlY3QoeCkudG9CZSgxKTtcbiAgICAgICAgZW1pdHRlZCA9IHRydWU7XG4gICAgICB9KTtcbiAgICAgIGVtaXR0ZXIuZW1pdCgnYScsIHt4OiAxfSk7XG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudCh2aXNpYmlsaXR5Y2hhbmdlRXZlbnQpO1xuICAgICAgZW1pdHRlci50ZWFyZG93bigpO1xuICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICB9O1xuICB9KTtcbiAgY29uc3Qgc2ltdWxhdG9yID0gZ2V0U2ltdWxhdG9yKGFwcCk7XG4gIGF3YWl0IHNpbXVsYXRvci5yZW5kZXIoJy8nKTtcblxuICBleHBlY3QobmF2aWdhdG9yLnNlbmRCZWFjb24pLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgZXhwZWN0KGZldGNoKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICBleHBlY3QoZW1pdHRlZCkudG9CZSh0cnVlKTtcbiAgZXhwZWN0KGZldGNoZWQpLnRvQmUodHJ1ZSk7XG4gIGV4cGVjdChzdG9yZS5kYXRhLmxlbmd0aCkudG9CZSgwKTtcbn0pO1xuXG50ZXN0KCdCcm93c2VyIEV2ZW50RW1pdHRlciBzaG91bGQgYXBwZW5kIHJvdXRlUHJlZml4IGlmIHNlbmRCZWFjb24gQVBJIGlzIHVzZWQnLCBhc3luYyAoKSA9PiB7XG4gIHdpbmRvdy5fX1JPVVRFX1BSRUZJWF9fID0gJy9yb3V0ZVByZWZpeCc7XG4gIG5hdmlnYXRvci5zZW5kQmVhY29uID0gamVzdC5mbigodXJsLCBwYXlsb2FkKSA9PiB7XG4gICAgZXhwZWN0KHVybCkudG9CZSgnL3JvdXRlUHJlZml4L19ldmVudHMnKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSk7XG4gIGNvbnN0IGZldGNoID0gamVzdC5mbigpO1xuICBjb25zdCBhcHAgPSBnZXRBcHAoZmV0Y2gpO1xuXG4gIGFwcC5taWRkbGV3YXJlKHtldmVudHM6IFVuaXZlcnNhbEV2ZW50c1Rva2VufSwgKHtldmVudHN9KSA9PiB7XG4gICAgcmV0dXJuIChjdHgsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IGVtaXR0ZXIgPSBldmVudHMuZnJvbShjdHgpO1xuICAgICAgZXhwZWN0KGVtaXR0ZXIpLnRvQmUoZXZlbnRzKTtcbiAgICAgIGVtaXR0ZXIuZW1pdCgnYScsIHt4OiAxfSk7XG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudCh2aXNpYmlsaXR5Y2hhbmdlRXZlbnQpO1xuICAgICAgZW1pdHRlci50ZWFyZG93bigpO1xuICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICB9O1xuICB9KTtcbiAgY29uc3Qgc2ltdWxhdG9yID0gZ2V0U2ltdWxhdG9yKGFwcCk7XG4gIGF3YWl0IHNpbXVsYXRvci5yZW5kZXIoJy8nKTtcbiAgZGVsZXRlIHdpbmRvdy5fX1JPVVRFX1BSRUZJWF9fO1xufSk7XG5cbnRlc3QoJ0Jyb3dzZXIgRXZlbnRFbWl0dGVyIHNob3VsZCBub3Qgcm91dGVQcmVmaXggaWYgZmV0Y2ggQVBJIGlzIHVzZWQgc2luY2UgaXQgaXMgYXBwZW5kZWQgaW4gY3NyZiBwbHVnaW4nLCBhc3luYyAoKSA9PiB7XG4gIHdpbmRvdy5fX1JPVVRFX1BSRUZJWF9fID0gJy9yb3V0ZVByZWZpeCc7XG4gIG5hdmlnYXRvci5zZW5kQmVhY29uID0gdW5kZWZpbmVkO1xuXG4gIGNvbnN0IGZldGNoID0gamVzdC5mbigpO1xuICBjb25zdCBhcHAgPSBnZXRBcHAoZmV0Y2gpO1xuXG4gIGFwcC5taWRkbGV3YXJlKHtldmVudHM6IFVuaXZlcnNhbEV2ZW50c1Rva2VufSwgKHtldmVudHN9KSA9PiB7XG4gICAgcmV0dXJuIChjdHgsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IGVtaXR0ZXIgPSBldmVudHMuZnJvbShjdHgpO1xuICAgICAgZXhwZWN0KGVtaXR0ZXIpLnRvQmUoZXZlbnRzKTtcbiAgICAgIGVtaXR0ZXIuZW1pdCgnYScsIHt4OiAxfSk7XG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudCh2aXNpYmlsaXR5Y2hhbmdlRXZlbnQpO1xuICAgICAgZW1pdHRlci50ZWFyZG93bigpO1xuICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICB9O1xuICB9KTtcbiAgY29uc3Qgc2ltdWxhdG9yID0gZ2V0U2ltdWxhdG9yKGFwcCk7XG4gIGF3YWl0IHNpbXVsYXRvci5yZW5kZXIoJy8nKTtcbiAgZXhwZWN0KGZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL19ldmVudHMnLCBleHBlY3QuYW55dGhpbmcoKSk7XG4gIGRlbGV0ZSB3aW5kb3cuX19ST1VURV9QUkVGSVhfXztcbn0pO1xuXG50ZXN0KCdCcm93c2VyIEV2ZW50RW1pdHRlciAtIHNob3VsZCBmYWxsIGJhY2sgdG8gZmV0Y2ggaWYgc2VuZEJlYWNvbiBpcyBub3Qgc3VwcG9ydGVkJywgYXN5bmMgKCkgPT4ge1xuICBsZXQgZmV0Y2hlZCA9IGZhbHNlO1xuICBsZXQgZW1pdHRlZCA9IGZhbHNlO1xuICBuYXZpZ2F0b3Iuc2VuZEJlYWNvbiA9IHVuZGVmaW5lZDtcbiAgY29uc3QgZmV0Y2g6IEZldGNoID0gamVzdC5mbigodXJsLCBvcHRpb25zKSA9PiB7XG4gICAgaWYgKFxuICAgICAgIW9wdGlvbnMgfHxcbiAgICAgICFvcHRpb25zLm1ldGhvZCB8fFxuICAgICAgIW9wdGlvbnMuaGVhZGVycyB8fFxuICAgICAgIW9wdGlvbnMuYm9keSB8fFxuICAgICAgdHlwZW9mIG9wdGlvbnMuYm9keSAhPT0gJ3N0cmluZydcbiAgICApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYEV4cGVjdGVkIG1ldGhvZCwgaGVhZGVycywgYm9keSBmcm9tIG9wdGlvbnMgYXJlIHBvcHVsYXRlZGBcbiAgICAgICk7XG4gICAgfVxuXG4gICAgbGV0IHttZXRob2QsIGhlYWRlcnMsIGJvZHl9ID0gb3B0aW9ucztcblxuICAgIGV4cGVjdCh1cmwpLnRvQmUoJy9fZXZlbnRzJyk7XG4gICAgZXhwZWN0KG1ldGhvZCkudG9CZSgnUE9TVCcpO1xuICAgIGV4cGVjdChcbiAgICAgIC8vICRGbG93Rml4TWVcbiAgICAgIGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddXG4gICAgKS50b0JlKCdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgY29uc3QganNvbkJvZHkgPSBKU09OLnBhcnNlKGJvZHkpO1xuICAgIGV4cGVjdChqc29uQm9keS5pdGVtcy5sZW5ndGgpLnRvQmUoMSk7XG4gICAgZXhwZWN0KGpzb25Cb2R5Lml0ZW1zWzBdLnBheWxvYWQueCkudG9CZSgxKTtcbiAgICBmZXRjaGVkID0gdHJ1ZTtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNyZWF0ZU1vY2tGZXRjaCgpKTtcbiAgfSk7XG5cbiAgY29uc3QgYXBwID0gZ2V0QXBwKGZldGNoKTtcbiAgYXBwLm1pZGRsZXdhcmUoe2V2ZW50czogVW5pdmVyc2FsRXZlbnRzVG9rZW59LCAoe2V2ZW50c30pID0+IHtcbiAgICByZXR1cm4gKGN0eCwgbmV4dCkgPT4ge1xuICAgICAgY29uc3QgZW1pdHRlciA9IGV2ZW50cy5mcm9tKGN0eCk7XG4gICAgICBleHBlY3QoZW1pdHRlcikudG9CZShldmVudHMpO1xuICAgICAgZW1pdHRlci5vbignYScsICh7eH0pID0+IHtcbiAgICAgICAgZXhwZWN0KHgpLnRvQmUoMSk7XG4gICAgICAgIGVtaXR0ZWQgPSB0cnVlO1xuICAgICAgfSk7XG4gICAgICBlbWl0dGVyLmVtaXQoJ2EnLCB7eDogMX0pO1xuICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQodmlzaWJpbGl0eWNoYW5nZUV2ZW50KTtcbiAgICAgIGVtaXR0ZXIudGVhcmRvd24oKTtcbiAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgfTtcbiAgfSk7XG4gIGNvbnN0IHNpbXVsYXRvciA9IGdldFNpbXVsYXRvcihhcHApO1xuICBhd2FpdCBzaW11bGF0b3IucmVuZGVyKCcvJyk7XG5cbiAgZXhwZWN0KGZldGNoKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gIGV4cGVjdChlbWl0dGVkKS50b0JlKHRydWUpO1xuICBleHBlY3QoZmV0Y2hlZCkudG9CZSh0cnVlKTtcbiAgZXhwZWN0KHN0b3JlLmRhdGEubGVuZ3RoKS50b0JlKDApO1xufSk7XG5cbnRlc3QoJ0Jyb3dzZXIgRXZlbnRFbWl0dGVyIC0gc2hvdWxkIGZhbGwgYmFjayB0byBmZXRjaCBpZiBiZWFjb24gZmFpbHMgdG8gZW5xdWV1ZScsIGFzeW5jICgpID0+IHtcbiAgbmF2aWdhdG9yLnNlbmRCZWFjb24gPSBqZXN0LmZuKCgpID0+IGZhbHNlKTtcbiAgY29uc3QgZmV0Y2g6IEZldGNoID0gamVzdC5mbigoKSA9PlxuICAgIFByb21pc2UucmVzb2x2ZShjcmVhdGVNb2NrRmV0Y2goe29rOiB0cnVlfSkpXG4gICk7XG5cbiAgY29uc3QgYXBwID0gZ2V0QXBwKGZldGNoKTtcbiAgYXBwLm1pZGRsZXdhcmUoe2V2ZW50czogVW5pdmVyc2FsRXZlbnRzVG9rZW59LCAoe2V2ZW50c30pID0+IHtcbiAgICByZXR1cm4gKGN0eCwgbmV4dCkgPT4ge1xuICAgICAgY29uc3QgZW1pdHRlciA9IGV2ZW50cy5mcm9tKGN0eCk7XG4gICAgICBleHBlY3QoZW1pdHRlcikudG9CZShldmVudHMpO1xuICAgICAgZW1pdHRlci5lbWl0KCdhJywge3g6IDF9KTtcbiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHZpc2liaWxpdHljaGFuZ2VFdmVudCk7XG4gICAgICBlbWl0dGVyLnRlYXJkb3duKCk7XG4gICAgICByZXR1cm4gbmV4dCgpO1xuICAgIH07XG4gIH0pO1xuICBjb25zdCBzaW11bGF0b3IgPSBnZXRTaW11bGF0b3IoYXBwKTtcbiAgYXdhaXQgc2ltdWxhdG9yLnJlbmRlcignLycpO1xuXG4gIGV4cGVjdChuYXZpZ2F0b3Iuc2VuZEJlYWNvbikudG9IYXZlQmVlbkNhbGxlZCgpO1xuICBleHBlY3QoZmV0Y2gpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgZXhwZWN0KHN0b3JlLmRhdGEubGVuZ3RoKS50b0JlKDApO1xufSk7XG5cbnRlc3QoJ0Jyb3dzZXIgRXZlbnRFbWl0dGVyIC0gc2hvdWxkIG5vdCBzZW5kIGFsbCB0aGUgZXZlbnRzIGlmIGJlYWNvbiBpcyB0b28gYmlnJywgYXN5bmMgKCkgPT4ge1xuICBuYXZpZ2F0b3Iuc2VuZEJlYWNvbiA9IGplc3QuZm4oKCkgPT4gdHJ1ZSk7XG4gIGNvbnN0IGZldGNoOiBGZXRjaCA9IGplc3QuZm4oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGNyZWF0ZU1vY2tGZXRjaCgpKSk7XG5cbiAgY29uc3QgYXBwID0gZ2V0QXBwKGZldGNoKTtcbiAgYXBwLm1pZGRsZXdhcmUoe2V2ZW50czogVW5pdmVyc2FsRXZlbnRzVG9rZW59LCAoe2V2ZW50c30pID0+IHtcbiAgICByZXR1cm4gKGN0eCwgbmV4dCkgPT4ge1xuICAgICAgY29uc3QgZW1pdHRlciA9IGV2ZW50cy5mcm9tKGN0eCk7XG4gICAgICBleHBlY3QoZW1pdHRlcikudG9CZShldmVudHMpO1xuICAgICAgZW1pdHRlci5lbWl0KCdhJywge3g6ICdhJy5yZXBlYXQoNDAwMDApfSk7XG4gICAgICBlbWl0dGVyLmVtaXQoJ2InLCB7eDogJ2InLnJlcGVhdCg0MDAwMCl9KTtcbiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHZpc2liaWxpdHljaGFuZ2VFdmVudCk7XG4gICAgICBlbWl0dGVyLnRlYXJkb3duKCk7XG4gICAgICByZXR1cm4gbmV4dCgpO1xuICAgIH07XG4gIH0pO1xuICBjb25zdCBzaW11bGF0b3IgPSBnZXRTaW11bGF0b3IoYXBwKTtcbiAgYXdhaXQgc2ltdWxhdG9yLnJlbmRlcignLycpO1xuXG4gIGV4cGVjdChuYXZpZ2F0b3Iuc2VuZEJlYWNvbikudG9IYXZlQmVlbkNhbGxlZCgpO1xuICBleHBlY3Qoc3RvcmUuZGF0YS5sZW5ndGgpLnRvQmUoMSk7XG59KTtcblxudGVzdCgnQnJvd3NlciBFdmVudEVtaXR0ZXIgLSBzaG91bGQgdXNlIGZldGNoIGlmIHNpbmdsZSBldmVudCBpcyBsYXJnZXIgdGhhbiBiZWFjb24gbGltaXQnLCBhc3luYyAoKSA9PiB7XG4gIG5hdmlnYXRvci5zZW5kQmVhY29uID0gamVzdC5mbigoKSA9PiB0cnVlKTtcbiAgY29uc3QgZmV0Y2g6IEZldGNoID0gamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoY3JlYXRlTW9ja0ZldGNoKCkpKTtcblxuICBjb25zdCBhcHAgPSBnZXRBcHAoZmV0Y2gpO1xuICBhcHAubWlkZGxld2FyZSh7ZXZlbnRzOiBVbml2ZXJzYWxFdmVudHNUb2tlbn0sICh7ZXZlbnRzfSkgPT4ge1xuICAgIHJldHVybiAoY3R4LCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCBlbWl0dGVyID0gZXZlbnRzLmZyb20oY3R4KTtcbiAgICAgIGV4cGVjdChlbWl0dGVyKS50b0JlKGV2ZW50cyk7XG4gICAgICBlbWl0dGVyLmVtaXQoJ2EnLCB7eDogJ2EnLnJlcGVhdCgxMDAwMDApfSk7XG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudCh2aXNpYmlsaXR5Y2hhbmdlRXZlbnQpO1xuICAgICAgZW1pdHRlci50ZWFyZG93bigpO1xuICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICB9O1xuICB9KTtcbiAgY29uc3Qgc2ltdWxhdG9yID0gZ2V0U2ltdWxhdG9yKGFwcCk7XG4gIGF3YWl0IHNpbXVsYXRvci5yZW5kZXIoJy8nKTtcblxuICBleHBlY3QoZmV0Y2gpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgZXhwZWN0KHN0b3JlLmRhdGEubGVuZ3RoKS50b0JlKDApO1xufSk7XG5cbnRlc3QoJ0Jyb3dzZXIgRXZlbnRFbWl0dGVyIC0gZmV0Y2ggYWRkcyBldmVudHMgYmFjayB0byBxdWV1ZSBpZiB0aGV5IGZhaWwgdG8gc2VuZCcsIGFzeW5jICgpID0+IHtcbiAgbmF2aWdhdG9yLnNlbmRCZWFjb24gPSB1bmRlZmluZWQ7XG4gIGNvbnN0IGZldGNoOiBGZXRjaCA9ICgpID0+IFByb21pc2UucmVzb2x2ZShjcmVhdGVNb2NrRmV0Y2goe29rOiBmYWxzZX0pKTtcblxuICBjb25zdCBhcHAgPSBnZXRBcHAoZmV0Y2gpO1xuICBhcHAubWlkZGxld2FyZSh7ZXZlbnRzOiBVbml2ZXJzYWxFdmVudHNUb2tlbn0sICh7ZXZlbnRzfSkgPT4ge1xuICAgIHJldHVybiAoY3R4LCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCBlbWl0dGVyID0gZXZlbnRzLmZyb20oY3R4KTtcbiAgICAgIGV4cGVjdChlbWl0dGVyKS50b0JlKGV2ZW50cyk7XG4gICAgICBlbWl0dGVyLmVtaXQoJ2EnLCB7eDogMX0pO1xuICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQodmlzaWJpbGl0eWNoYW5nZUV2ZW50KTtcbiAgICAgIGVtaXR0ZXIudGVhcmRvd24oKTtcbiAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgfTtcbiAgfSk7XG4gIGNvbnN0IHNpbXVsYXRvciA9IGdldFNpbXVsYXRvcihhcHApO1xuICBhd2FpdCBzaW11bGF0b3IucmVuZGVyKCcvJyk7XG5cbiAgZXhwZWN0KHN0b3JlLmRhdGEubGVuZ3RoKS50b0JlKDEpO1xufSk7XG5cbnRlc3QoJ0Jyb3dzZXIgRXZlbnRFbWl0dGVyIC0gZmV0Y2ggYWRkcyBldmVudHMgYmFjayB0byBxdWV1ZSBpZiB0aGV5IGZhaWwgdG8gc2VuZCAyJywgYXN5bmMgKCkgPT4ge1xuICBuYXZpZ2F0b3Iuc2VuZEJlYWNvbiA9IHVuZGVmaW5lZDtcbiAgY29uc3QgZmV0Y2g6IEZldGNoID0gKCkgPT4gUHJvbWlzZS5yZWplY3QoKTtcblxuICBjb25zdCBhcHAgPSBnZXRBcHAoZmV0Y2gpO1xuICBhcHAubWlkZGxld2FyZSh7ZXZlbnRzOiBVbml2ZXJzYWxFdmVudHNUb2tlbn0sICh7ZXZlbnRzfSkgPT4ge1xuICAgIHJldHVybiAoY3R4LCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCBlbWl0dGVyID0gZXZlbnRzLmZyb20oY3R4KTtcbiAgICAgIGV4cGVjdChlbWl0dGVyKS50b0JlKGV2ZW50cyk7XG4gICAgICBlbWl0dGVyLmVtaXQoJ2EnLCB7eDogMX0pO1xuICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQodmlzaWJpbGl0eWNoYW5nZUV2ZW50KTtcbiAgICAgIGVtaXR0ZXIudGVhcmRvd24oKTtcbiAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgfTtcbiAgfSk7XG4gIGNvbnN0IHNpbXVsYXRvciA9IGdldFNpbXVsYXRvcihhcHApO1xuICBhd2FpdCBzaW11bGF0b3IucmVuZGVyKCcvJyk7XG5cbiAgZXhwZWN0KHN0b3JlLmRhdGEubGVuZ3RoKS50b0JlKDEpO1xufSk7XG5cbnRlc3QoJ0Jyb3dzZXIgRXZlbnRFbWl0dGVyIGludGVydmFsJywgKGRvbmUpID0+IHtcbiAgbmF2aWdhdG9yLnNlbmRCZWFjb24gPSBqZXN0LmZuKCgpID0+IHRydWUpO1xuICBzdG9yZS5nZXRBbmRDbGVhcigpO1xuICBjb25zdCBlbWl0dGVyID0gbmV3IFVuaXZlcnNhbEVtaXR0ZXIoXG4gICAgKCkgPT4ge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjcmVhdGVNb2NrRmV0Y2goKSk7XG4gICAgfSxcbiAgICB7XG4gICAgICBhZGQoKSB7fSxcbiAgICAgIGFkZFRvU3RhcnQoKSB7fSxcbiAgICAgIGdldEFuZENsZWFyKCkge1xuICAgICAgICBleHBlY3QoJ0NhbGxzIHN0b3JhZ2UgZ2V0QW5kQ2xlYXIgb24gaW50ZXJ2YWwnKS50b0JlVHJ1dGh5KCk7XG4gICAgICAgIGVtaXR0ZXIudGVhcmRvd24oKTtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9LFxuICAgIH0sXG4gICAgMVxuICApO1xufSk7XG5cbnRlc3QoJ1Jlc3BlY3RzIHRoZSBsaW1pdCB3aGVuIGZsdXNoaW5nJywgYXN5bmMgKCkgPT4ge1xuICBuYXZpZ2F0b3Iuc2VuZEJlYWNvbiA9IGplc3QuZm4oKCkgPT4gdHJ1ZSk7XG4gIHN0b3JlLmdldEFuZENsZWFyKCk7XG4gIGNvbnN0IGZldGNoOiBGZXRjaCA9ICgpID0+IFByb21pc2UucmVzb2x2ZShjcmVhdGVNb2NrRmV0Y2goKSk7XG4gIGNvbnN0IGVtaXR0ZXIgPSBuZXcgVW5pdmVyc2FsRW1pdHRlcihmZXRjaCwgc3RvcmUsIDIwMDAsIDIwKTtcbiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IDUwOyBpbmRleCsrKSB7XG4gICAgZW1pdHRlci5lbWl0KCdhJywge3g6IDF9KTtcbiAgfVxuICBhd2FpdCBlbWl0dGVyLmZsdXNoKCk7XG4gIGV4cGVjdChzdG9yZS5kYXRhLmxlbmd0aCkudG9CZSgzMCk7XG4gIGF3YWl0IGVtaXR0ZXIuZmx1c2goKTtcbiAgZXhwZWN0KHN0b3JlLmRhdGEubGVuZ3RoKS50b0JlKDEwKTtcbiAgYXdhaXQgZW1pdHRlci5mbHVzaCgpO1xuICBleHBlY3Qoc3RvcmUuZGF0YS5sZW5ndGgpLnRvQmUoMCk7XG4gIGVtaXR0ZXIudGVhcmRvd24oKTtcbn0pO1xuXG50ZXN0KCdDYWxsaW5nIGZsdXNoIGV2ZW4gbm8gaXRlbXMgd29ya3MgYXMgZXhwZWN0ZWQnLCBhc3luYyAoKSA9PiB7XG4gIG5hdmlnYXRvci5zZW5kQmVhY29uID0gamVzdC5mbigoKSA9PiB0cnVlKTtcbiAgc3RvcmUuZ2V0QW5kQ2xlYXIoKTtcbiAgY29uc3QgZmV0Y2g6IEZldGNoID0gKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGNyZWF0ZU1vY2tGZXRjaCgpKTtcbiAgY29uc3QgZW1pdHRlciA9IG5ldyBVbml2ZXJzYWxFbWl0dGVyKGZldGNoLCBzdG9yZSwgMTAwLCAyMCk7XG4gIGF3YWl0IGVtaXR0ZXIuZmx1c2goKTtcbiAgYXdhaXQgZW1pdHRlci5mbHVzaCgpO1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAzMDAwKSk7XG4gIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCAyMDsgaW5kZXgrKykge1xuICAgIGVtaXR0ZXIuZW1pdCgnYScsIHt4OiAxfSk7XG4gIH1cbiAgYXdhaXQgZW1pdHRlci5mbHVzaCgpO1xuICBleHBlY3Qoc3RvcmUuZGF0YS5sZW5ndGgpLnRvQmUoMCk7XG4gIGVtaXR0ZXIudGVhcmRvd24oKTtcbn0pO1xuXG50ZXN0KCdGZXRjaCBsb3dlcnMgbGltaXQgZm9yIDQxMyBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gIG5hdmlnYXRvci5zZW5kQmVhY29uID0gdW5kZWZpbmVkO1xuICBzdG9yZS5nZXRBbmRDbGVhcigpO1xuICBjb25zdCBmZXRjaDogRmV0Y2ggPSAoKSA9PlxuICAgIFByb21pc2UucmVzb2x2ZShjcmVhdGVNb2NrRmV0Y2goe3N0YXR1czogNDEzLCBvazogZmFsc2V9KSk7XG4gIGNvbnN0IGVtaXR0ZXIgPSBuZXcgVW5pdmVyc2FsRW1pdHRlcihmZXRjaCwgc3RvcmUsIDIwMDAsIDIwKTtcbiAgZW1pdHRlci5lbWl0KCdhJywge3g6IDF9KTtcbiAgYXdhaXQgZW1pdHRlci5mbHVzaCgpO1xuICBleHBlY3Qoc3RvcmUuZGF0YS5sZW5ndGgpLnRvQmUoMSk7XG4gIGV4cGVjdChlbWl0dGVyLmxpbWl0KS50b0JlKDEwKTtcbiAgYXdhaXQgZW1pdHRlci5mbHVzaCgpO1xuICBleHBlY3QoZW1pdHRlci5saW1pdCkudG9CZSg1KTtcbiAgYXdhaXQgZW1pdHRlci5mbHVzaCgpO1xuICBlbWl0dGVyLnRlYXJkb3duKCk7XG59KTtcblxuY29uc3Qgc2xlZXAgPSAobXMpID0+IHNldFRpbWVvdXQoKCkgPT4ge30sIG1zKTtcblxudGVzdCgnQnJvd3NlciBFdmVudEVtaXR0ZXIgZG9lcyBub3Qgc3RhcnQgYSBuZXcgZmx1c2ggd2hpbGUgYW5vdGhlciBvbmUgaXMgaW4gcHJvZ3Jlc3MnLCBhc3luYyAoKSA9PiB7XG4gIG5hdmlnYXRvci5zZW5kQmVhY29uID0gdW5kZWZpbmVkO1xuICBzdG9yZS5nZXRBbmRDbGVhcigpO1xuICBsZXQgcmVzb2x2ZUZldGNoOiAocmVzdWx0OiBhbnkpID0+IHZvaWQgPSAoKSA9PiB7fTtcbiAgY29uc3QgZmV0Y2g6IEZldGNoID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShcbiAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgcmVzb2x2ZUZldGNoID0gcmVzb2x2ZTtcbiAgICB9KVxuICApO1xuICBjb25zdCBlbWl0dGVyID0gbmV3IFVuaXZlcnNhbEVtaXR0ZXIoZmV0Y2gsIHN0b3JlLCAyMDAwLCAyMCk7XG4gIGVtaXR0ZXIuZW1pdCgnYScsIHt4OiAxfSk7XG4gIGVtaXR0ZXIuZmx1c2goKTtcbiAgZW1pdHRlci5lbWl0KCdiJywge3k6IDF9KTtcbiAgZW1pdHRlci5mbHVzaCgpO1xuICBlbWl0dGVyLmZsdXNoKCk7XG4gIC8vIGZpcnN0IHJlcXVlc3QgaXMgbm90IHJlc29sdmVkLCBvbmx5IG9uZSByZXF1ZXN0IGF0IHRoZSBtb21lbnRcbiAgZXhwZWN0KGZldGNoKS50b0JlQ2FsbGVkVGltZXMoMSk7XG4gIHJlc29sdmVGZXRjaChjcmVhdGVNb2NrRmV0Y2goKSk7XG4gIGF3YWl0IHNsZWVwKDEpO1xuICAvLyBzY2hlZHVsZWQgZmx1c2ggc2hvdWxkIGJlIHN0YXJ0ZWQgYWZ0ZXIgZmlyc3QgcmVxdWVzdC9mbHVzaCBpcyByZXNvbHZlZFxuICBleHBlY3QoZmV0Y2gpLnRvQmVDYWxsZWRUaW1lcygyKTtcbiAgcmVzb2x2ZUZldGNoKGNyZWF0ZU1vY2tGZXRjaCgpKTtcbiAgYXdhaXQgc2xlZXAoMSk7XG4gIC8vIG5vIG1vcmUgYWRkaXRpb25hbCBmbHVzaCBpcyBuZWVkZWQgYXMgZmFyIGFzIG5vIGV2ZW50cyB3ZXJlIGVtaXR0ZWRcbiAgZXhwZWN0KGZldGNoKS50b0JlQ2FsbGVkVGltZXMoMik7XG4gIGVtaXR0ZXIudGVhcmRvd24oKTtcbn0pO1xuXG50ZXN0KCdCcm93c2VyIEV2ZW50RW1pdHRlciAtIHNob3VsZCBub3Qgc2VuZCBwYXlsb2FkcyBsYXJnZXIgdGhhbiB4aHIgYm9keSBsaW1pdCcsIGFzeW5jICgpID0+IHtcbiAgY29uc3QgZmV0Y2g6IEZldGNoID0gamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoY3JlYXRlTW9ja0ZldGNoKCkpKTtcblxuICBjb25zdCBhcHAgPSBnZXRBcHAoZmV0Y2gpO1xuICBhcHAubWlkZGxld2FyZSh7ZXZlbnRzOiBVbml2ZXJzYWxFdmVudHNUb2tlbn0sICh7ZXZlbnRzfSkgPT4ge1xuICAgIHJldHVybiAoY3R4LCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCBlbWl0dGVyID0gZXZlbnRzLmZyb20oY3R4KTtcbiAgICAgIGV4cGVjdChlbWl0dGVyKS50b0JlKGV2ZW50cyk7XG4gICAgICAvLyBlbWl0IDUgZXZlbnRzIHRoYXQgYXJlIGVhY2ggc2xpZ2hseSB1bmRlciBoYWxmIHRoZSBtYXggcGF5bG9hZCBsaW1pdFxuICAgICAgZW1pdHRlci5lbWl0KCdhJywge3g6ICdhJy5yZXBlYXQoMTA0ODU3NiAvIDIgLSAxMDApfSk7XG4gICAgICBlbWl0dGVyLmVtaXQoJ2InLCB7eDogJ2InLnJlcGVhdCgxMDQ4NTc2IC8gMiAtIDEwMCl9KTtcbiAgICAgIGVtaXR0ZXIuZW1pdCgnYycsIHt4OiAnYycucmVwZWF0KDEwNDg1NzYgLyAyIC0gMTAwKX0pO1xuICAgICAgZW1pdHRlci5lbWl0KCdkJywge3g6ICdlJy5yZXBlYXQoMTA0ODU3NiAvIDIgLSAxMDApfSk7XG4gICAgICBlbWl0dGVyLmVtaXQoJ2UnLCB7eDogJ2UnLnJlcGVhdCgxMDQ4NTc2IC8gMiAtIDEwMCl9KTtcbiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHZpc2liaWxpdHljaGFuZ2VFdmVudCk7XG4gICAgICBlbWl0dGVyLnRlYXJkb3duKCk7XG4gICAgICByZXR1cm4gbmV4dCgpO1xuICAgIH07XG4gIH0pO1xuXG4gIGNvbnN0IHNpbXVsYXRvciA9IGdldFNpbXVsYXRvcihhcHApO1xuICBhd2FpdCBzaW11bGF0b3IucmVuZGVyKCcvJyk7XG4gIGV4cGVjdChzdG9yZS5kYXRhLmxlbmd0aCkudG9CZSgzKTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsT0FBTyxjQUFjLENBQUMsQ0FBQzs7QUFFdkIsT0FBT0EsR0FBRyxNQUFNLGFBQWE7QUFDN0IsU0FBUUMsVUFBVSxRQUFPLGVBQWU7QUFFeEMsU0FBUUMsWUFBWSxRQUFPLG1CQUFtQjtBQUU5QyxPQUFPQyxNQUFNLElBQUdDLGdCQUFnQixRQUFPLFlBQVk7QUFDbkQsU0FBUUMsb0JBQW9CLFFBQU8sVUFBVTtBQUM3QyxTQUNFQyxnQ0FBZ0MsRUFDaENDLG9CQUFvQixJQUFJQyxLQUFLLFFBQ3hCLGtCQUFrQjs7QUFFekI7QUFDQUMsTUFBTSxDQUFDQyxjQUFjLENBQUNDLFFBQVEsRUFBRSxpQkFBaUIsRUFBRTtFQUFDQyxLQUFLLEVBQUU7QUFBUSxDQUFDLENBQUM7QUFDckUsTUFBTUMscUJBQXFCLEdBQUcsSUFBSUMsS0FBSyxDQUFDLGtCQUFrQixDQUFDOztBQUUzRDtBQUNBLFNBQVNDLE1BQU0sQ0FBQ0MsS0FBWSxFQUFFO0VBQzVCLE1BQU1DLEdBQUcsR0FBRyxJQUFJakIsR0FBRyxDQUFDLElBQUksRUFBR2tCLEVBQUUsSUFBS0EsRUFBRSxDQUFDO0VBQ3JDRCxHQUFHLENBQUNFLFFBQVEsQ0FBQ2xCLFVBQVUsRUFBRWUsS0FBSyxDQUFDO0VBQy9CUixLQUFLLENBQUNZLFdBQVcsRUFBRTtFQUNuQkgsR0FBRyxDQUFDRSxRQUFRLENBQUNiLGdDQUFnQyxFQUFFRSxLQUFLLENBQUM7RUFDckRTLEdBQUcs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
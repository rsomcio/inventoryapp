"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.TokenType = exports.TokenImpl = void 0;
exports.createToken = createToken;
exports.getTokenRef = getTokenRef;
var _stackTrace = require("./stack-trace");
/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

const TokenType = Object.freeze({
  Required: 0,
  Optional: 1
});
exports.TokenType = TokenType;
function Ref() {}
class TokenImpl {
  constructor(name, ref) {
    this.name = name;
    this.ref = ref || new Ref();
    this.type = ref ? TokenType.Optional : TokenType.Required;
    this.stacks = [{
      type: 'token',
      stack: (0, _stackTrace.captureStackTrace)(createToken)
    }];
    if (!ref) {
      this.optional = new TokenImpl(name, this.ref);
    }
  }
}
exports.TokenImpl = TokenImpl;
function createToken(name) {
  return new TokenImpl(name);
}
function getTokenRef(token) {
  if (token instanceof TokenImpl) {
    return token.ref;
  }
  return token;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUb2tlblR5cGUiLCJPYmplY3QiLCJmcmVlemUiLCJSZXF1aXJlZCIsIk9wdGlvbmFsIiwiUmVmIiwiVG9rZW5JbXBsIiwiY29uc3RydWN0b3IiLCJuYW1lIiwicmVmIiwidHlwZSIsInN0YWNrcyIsInN0YWNrIiwiY2FwdHVyZVN0YWNrVHJhY2UiLCJjcmVhdGVUb2tlbiIsIm9wdGlvbmFsIiwiZ2V0VG9rZW5SZWYiLCJ0b2tlbiJdLCJzb3VyY2VzIjpbInNyYy9jcmVhdGUtdG9rZW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIENvcHlyaWdodCAoYykgMjAxOCBVYmVyIFRlY2hub2xvZ2llcywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqL1xuXG5pbXBvcnQgdHlwZSB7VG9rZW59IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHtjYXB0dXJlU3RhY2tUcmFjZX0gZnJvbSAnLi9zdGFjay10cmFjZSc7XG5cbmV4cG9ydCBjb25zdCBUb2tlblR5cGUgPSBPYmplY3QuZnJlZXplKHtcbiAgUmVxdWlyZWQ6IDAsXG4gIE9wdGlvbmFsOiAxLFxufSk7XG5mdW5jdGlvbiBSZWYoKSB7fVxuZXhwb3J0IGNsYXNzIFRva2VuSW1wbDxUUmVzb2x2ZWQ+IHtcbiAgbmFtZTogc3RyaW5nO1xuICByZWY6IHVua25vd247XG4gIHR5cGU6IHR5cGVvZiBUb2tlblR5cGVba2V5b2YgdHlwZW9mIFRva2VuVHlwZV07XG4gIG9wdGlvbmFsOiBUb2tlbkltcGw8VFJlc29sdmVkPiB8IHVuZGVmaW5lZDtcbiAgc3RhY2tzOiBBcnJheTx7XG4gICAgdHlwZTogJ3Rva2VuJyB8ICdyZWdpc3RlcicgfCAnZW5oYW5jZScgfCAnYWxpYXMtZnJvbScgfCAnYWxpYXMtdG8nO1xuICAgIHN0YWNrOiBzdHJpbmc7XG4gIH0+O1xuXG4gIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgcmVmPzogdW5rbm93bikge1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5yZWYgPSByZWYgfHwgbmV3IFJlZigpO1xuICAgIHRoaXMudHlwZSA9IHJlZiA/IFRva2VuVHlwZS5PcHRpb25hbCA6IFRva2VuVHlwZS5SZXF1aXJlZDtcbiAgICB0aGlzLnN0YWNrcyA9IFt7dHlwZTogJ3Rva2VuJywgc3RhY2s6IGNhcHR1cmVTdGFja1RyYWNlKGNyZWF0ZVRva2VuKX1dO1xuICAgIGlmICghcmVmKSB7XG4gICAgICB0aGlzLm9wdGlvbmFsID0gbmV3IFRva2VuSW1wbChuYW1lLCB0aGlzLnJlZik7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUb2tlbjxUUmVzb2x2ZWRUeXBlPihuYW1lOiBzdHJpbmcpOiBUb2tlbjxUUmVzb2x2ZWRUeXBlPiB7XG4gIHJldHVybiBuZXcgVG9rZW5JbXBsKG5hbWUpIGFzIGFueSBhcyBUb2tlbjxUUmVzb2x2ZWRUeXBlPjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRva2VuUmVmKHRva2VuKSB7XG4gIGlmICh0b2tlbiBpbnN0YW5jZW9mIFRva2VuSW1wbCkge1xuICAgIHJldHVybiB0b2tlbi5yZWY7XG4gIH1cbiAgcmV0dXJuIHRva2VuO1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQVFBO0FBUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUtPLE1BQU1BLFNBQVMsR0FBR0MsTUFBTSxDQUFDQyxNQUFNLENBQUM7RUFDckNDLFFBQVEsRUFBRSxDQUFDO0VBQ1hDLFFBQVEsRUFBRTtBQUNaLENBQUMsQ0FBQztBQUFDO0FBQ0gsU0FBU0MsR0FBRyxHQUFHLENBQUM7QUFDVCxNQUFNQyxTQUFTLENBQVk7RUFVaENDLFdBQVcsQ0FBQ0MsSUFBWSxFQUFFQyxHQUFhLEVBQUU7SUFDdkMsSUFBSSxDQUFDRCxJQUFJLEdBQUdBLElBQUk7SUFDaEIsSUFBSSxDQUFDQyxHQUFHLEdBQUdBLEdBQUcsSUFBSSxJQUFJSixHQUFHLEVBQUU7SUFDM0IsSUFBSSxDQUFDSyxJQUFJLEdBQUdELEdBQUcsR0FBR1QsU0FBUyxDQUFDSSxRQUFRLEdBQUdKLFNBQVMsQ0FBQ0csUUFBUTtJQUN6RCxJQUFJLENBQUNRLE1BQU0sR0FBRyxDQUFDO01BQUNELElBQUksRUFBRSxPQUFPO01BQUVFLEtBQUssRUFBRSxJQUFBQyw2QkFBaUIsRUFBQ0MsV0FBVztJQUFDLENBQUMsQ0FBQztJQUN0RSxJQUFJLENBQUNMLEdBQUcsRUFBRTtNQUNSLElBQUksQ0FBQ00sUUFBUSxHQUFHLElBQUlULFNBQVMsQ0FBQ0UsSUFBSSxFQUFFLElBQUksQ0FBQ0MsR0FBRyxDQUFDO0lBQy9DO0VBQ0Y7QUFDRjtBQUFDO0FBRU0sU0FBU0ssV0FBVyxDQUFnQk4sSUFBWSxFQUF3QjtFQUM3RSxPQUFPLElBQUlGLFNBQVMsQ0FBQ0UsSUFBSSxDQUFDO0FBQzVCO0FBRU8sU0FBU1EsV0FBVyxDQUFDQyxLQUFLLEVBQUU7RUFDakMsSUFBSUEsS0FBSyxZQUFZWCxTQUFTLEVBQUU7SUFDOUIsT0FBT1csS0FBSyxDQUFDUixHQUFHO0VBQ2xCO0VBQ0EsT0FBT1EsS0FBSztBQUNkIn0=
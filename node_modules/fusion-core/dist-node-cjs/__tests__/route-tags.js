"use strict";

var _serverApp = _interopRequireDefault(require("../server-app"));
var _testHelper = require("./test-helper");
var _tokens = require("../tokens");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
const App = false ? ClientAppFactory() : (0, _serverApp.default)();
test('timing plugin', async () => {
  const element = 'hi';
  const renderFn = el => {
    return el;
  };
  const app = new App(element, renderFn);
  expect.assertions(4);
  app.middleware({
    RouteTags: _tokens.RouteTagsToken
  }, ({
    RouteTags
  }) => async (ctx, next) => {
    const tags = RouteTags.from(ctx);
    expect(tags.name).toBe('unknown_route');
    await next();
    expect(tags.name).toBe('test');
    expect(tags.test).toBe('something');
  });
  app.middleware({
    RouteTags: _tokens.RouteTagsToken
  }, ({
    RouteTags
  }) => (ctx, next) => {
    const tags = RouteTags.from(ctx);
    expect(tags.name).toBe('unknown_route');
    tags.name = 'test';
    tags.test = 'something';
    return next();
  });
  await (0, _testHelper.run)(app);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcHAiLCJDbGllbnRBcHBGYWN0b3J5IiwiU2VydmVyQXBwRmFjdG9yeSIsInRlc3QiLCJlbGVtZW50IiwicmVuZGVyRm4iLCJlbCIsImFwcCIsImV4cGVjdCIsImFzc2VydGlvbnMiLCJtaWRkbGV3YXJlIiwiUm91dGVUYWdzIiwiUm91dGVUYWdzVG9rZW4iLCJjdHgiLCJuZXh0IiwidGFncyIsImZyb20iLCJuYW1lIiwidG9CZSIsInJ1biJdLCJzb3VyY2VzIjpbInNyYy9fX3Rlc3RzX18vcm91dGUtdGFncy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2xpZW50QXBwRmFjdG9yeSBmcm9tICcuLi9jbGllbnQtYXBwJztcbmltcG9ydCBTZXJ2ZXJBcHBGYWN0b3J5IGZyb20gJy4uL3NlcnZlci1hcHAnO1xuaW1wb3J0IHtydW59IGZyb20gJy4vdGVzdC1oZWxwZXInO1xuaW1wb3J0IHtSb3V0ZVRhZ3NUb2tlbn0gZnJvbSAnLi4vdG9rZW5zJztcblxuY29uc3QgQXBwID0gX19CUk9XU0VSX18gPyBDbGllbnRBcHBGYWN0b3J5KCkgOiBTZXJ2ZXJBcHBGYWN0b3J5KCk7XG5cbnRlc3QoJ3RpbWluZyBwbHVnaW4nLCBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IGVsZW1lbnQgPSAnaGknO1xuICBjb25zdCByZW5kZXJGbiA9IChlbCkgPT4ge1xuICAgIHJldHVybiBlbDtcbiAgfTtcbiAgY29uc3QgYXBwID0gbmV3IEFwcChlbGVtZW50LCByZW5kZXJGbik7XG4gIGV4cGVjdC5hc3NlcnRpb25zKDQpO1xuICBhcHAubWlkZGxld2FyZShcbiAgICB7Um91dGVUYWdzOiBSb3V0ZVRhZ3NUb2tlbn0sXG4gICAgKHtSb3V0ZVRhZ3N9KSA9PlxuICAgICAgYXN5bmMgKGN0eCwgbmV4dCkgPT4ge1xuICAgICAgICBjb25zdCB0YWdzID0gUm91dGVUYWdzLmZyb20oY3R4KTtcbiAgICAgICAgZXhwZWN0KHRhZ3MubmFtZSkudG9CZSgndW5rbm93bl9yb3V0ZScpO1xuICAgICAgICBhd2FpdCBuZXh0KCk7XG4gICAgICAgIGV4cGVjdCh0YWdzLm5hbWUpLnRvQmUoJ3Rlc3QnKTtcbiAgICAgICAgZXhwZWN0KHRhZ3MudGVzdCkudG9CZSgnc29tZXRoaW5nJyk7XG4gICAgICB9XG4gICk7XG5cbiAgYXBwLm1pZGRsZXdhcmUoe1JvdXRlVGFnczogUm91dGVUYWdzVG9rZW59LCAoe1JvdXRlVGFnc30pID0+IChjdHgsIG5leHQpID0+IHtcbiAgICBjb25zdCB0YWdzID0gUm91dGVUYWdzLmZyb20oY3R4KTtcbiAgICBleHBlY3QodGFncy5uYW1lKS50b0JlKCd1bmtub3duX3JvdXRlJyk7XG4gICAgdGFncy5uYW1lID0gJ3Rlc3QnO1xuICAgIHRhZ3MudGVzdCA9ICdzb21ldGhpbmcnO1xuICAgIHJldHVybiBuZXh0KCk7XG4gIH0pO1xuICBhd2FpdCBydW4oYXBwKTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiOztBQUNBO0FBQ0E7QUFDQTtBQUF5QztBQUV6QyxNQUFNQSxHQUFHLEdBQUcsUUFBY0MsZ0JBQWdCLEVBQUUsR0FBRyxJQUFBQyxrQkFBZ0IsR0FBRTtBQUVqRUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxZQUFZO0VBQ2hDLE1BQU1DLE9BQU8sR0FBRyxJQUFJO0VBQ3BCLE1BQU1DLFFBQVEsR0FBSUMsRUFBRSxJQUFLO0lBQ3ZCLE9BQU9BLEVBQUU7RUFDWCxDQUFDO0VBQ0QsTUFBTUMsR0FBRyxHQUFHLElBQUlQLEdBQUcsQ0FBQ0ksT0FBTyxFQUFFQyxRQUFRLENBQUM7RUFDdENHLE1BQU0sQ0FBQ0MsVUFBVSxDQUFDLENBQUMsQ0FBQztFQUNwQkYsR0FBRyxDQUFDRyxVQUFVLENBQ1o7SUFBQ0MsU0FBUyxFQUFFQztFQUFjLENBQUMsRUFDM0IsQ0FBQztJQUFDRDtFQUFTLENBQUMsS0FDVixPQUFPRSxHQUFHLEVBQUVDLElBQUksS0FBSztJQUNuQixNQUFNQyxJQUFJLEdBQUdKLFNBQVMsQ0FBQ0ssSUFBSSxDQUFDSCxHQUFHLENBQUM7SUFDaENMLE1BQU0sQ0FBQ08sSUFBSSxDQUFDRSxJQUFJLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLGVBQWUsQ0FBQztJQUN2QyxNQUFNSixJQUFJLEVBQUU7SUFDWk4sTUFBTSxDQUFDTyxJQUFJLENBQUNFLElBQUksQ0FBQyxDQUFDQyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQzlCVixNQUFNLENBQUNPLElBQUksQ0FBQ1osSUFBSSxDQUFDLENBQUNlLElBQUksQ0FBQyxXQUFXLENBQUM7RUFDckMsQ0FBQyxDQUNKO0VBRURYLEdBQUcsQ0FBQ0csVUFBVSxDQUFDO0lBQUNDLFNBQVMsRUFBRUM7RUFBYyxDQUFDLEVBQUUsQ0FBQztJQUFDRDtFQUFTLENBQUMsS0FBSyxDQUFDRSxHQUFHLEVBQUVDLElBQUksS0FBSztJQUMxRSxNQUFNQyxJQUFJLEdBQUdKLFNBQVMsQ0FBQ0ssSUFBSSxDQUFDSCxHQUFHLENBQUM7SUFDaENMLE1BQU0sQ0FBQ08sSUFBSSxDQUFDRSxJQUFJLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLGVBQWUsQ0FBQztJQUN2Q0gsSUFBSSxDQUFDRSxJQUFJLEdBQUcsTUFBTTtJQUNsQkYsSUFBSSxDQUFDWixJQUFJLEdBQUcsV0FBVztJQUN2QixPQUFPVyxJQUFJLEVBQUU7RUFDZixDQUFDLENBQUM7RUFDRixNQUFNLElBQUFLLGVBQUcsRUFBQ1osR0FBRyxDQUFDO0FBQ2hCLENBQUMsQ0FBQyJ9
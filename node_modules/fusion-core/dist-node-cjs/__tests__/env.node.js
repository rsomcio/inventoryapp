"use strict";

var _getEnv = require("../get-env");
/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */
/* eslint-env node */

test('loadEnv defaults', () => {
  process.env.NODE_ENV = '';
  const env = (0, _getEnv.loadEnv)()();
  expect(env).toEqual({
    rootDir: '.',
    env: 'development',
    prefix: '',
    assetPath: '/_static',
    baseAssetPath: '/_static',
    cdnUrl: '',
    webpackPublicPath: '/_static',
    dangerouslyExposeSourceMaps: false
  });
});
test('loadEnv overrides', () => {
  process.env.ROOT_DIR = 'test_root_dir';
  process.env.NODE_ENV = 'production';
  process.env.ROUTE_PREFIX = 'test_route_prefix';
  process.env.FRAMEWORK_STATIC_ASSET_PATH = '/test_framework';
  process.env.CDN_URL = 'test_cdn_url';
  process.env.DANGEROUSLY_EXPOSE_SOURCE_MAPS = 'true';
  const env = (0, _getEnv.loadEnv)()();
  expect(env).toEqual({
    rootDir: 'test_root_dir',
    env: 'production',
    prefix: 'test_route_prefix',
    assetPath: 'test_route_prefix/test_framework',
    baseAssetPath: '/test_framework',
    cdnUrl: 'test_cdn_url',
    webpackPublicPath: 'test_cdn_url',
    dangerouslyExposeSourceMaps: true
  });
  process.env.ROOT_DIR = '';
  process.env.NODE_ENV = '';
  process.env.ROUTE_PREFIX = '';
  process.env.FRAMEWORK_STATIC_ASSET_PATH = '';
  process.env.CDN_URL = '';
});
test('loadEnv validation', () => {
  process.env.NODE_ENV = 'LOL';
  expect(_getEnv.loadEnv).toThrow(/Invalid NODE_ENV loaded/);
  process.env.NODE_ENV = '';
  process.env.ROUTE_PREFIX = 'test/';
  expect(_getEnv.loadEnv).toThrow(/ROUTE_PREFIX must not end with /);
  process.env.ROUTE_PREFIX = '';
  process.env.FRAMEWORK_STATIC_ASSET_PATH = 'test/';
  expect(_getEnv.loadEnv).toThrow(/FRAMEWORK_STATIC_ASSET_PATH must not end with /);
  process.env.FRAMEWORK_STATIC_ASSET_PATH = '';
  process.env.CDN_URL = 'test/';
  expect(_getEnv.loadEnv).toThrow(/CDN_URL must not end with /);
  process.env.CDN_URL = '';
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ0ZXN0IiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwibG9hZEVudiIsImV4cGVjdCIsInRvRXF1YWwiLCJyb290RGlyIiwicHJlZml4IiwiYXNzZXRQYXRoIiwiYmFzZUFzc2V0UGF0aCIsImNkblVybCIsIndlYnBhY2tQdWJsaWNQYXRoIiwiZGFuZ2Vyb3VzbHlFeHBvc2VTb3VyY2VNYXBzIiwiUk9PVF9ESVIiLCJST1VURV9QUkVGSVgiLCJGUkFNRVdPUktfU1RBVElDX0FTU0VUX1BBVEgiLCJDRE5fVVJMIiwiREFOR0VST1VTTFlfRVhQT1NFX1NPVVJDRV9NQVBTIiwidG9UaHJvdyJdLCJzb3VyY2VzIjpbInNyYy9fX3Rlc3RzX18vZW52Lm5vZGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIENvcHlyaWdodCAoYykgMjAxOCBVYmVyIFRlY2hub2xvZ2llcywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqL1xuLyogZXNsaW50LWVudiBub2RlICovXG5pbXBvcnQge2xvYWRFbnZ9IGZyb20gJy4uL2dldC1lbnYnO1xuXG50ZXN0KCdsb2FkRW52IGRlZmF1bHRzJywgKCkgPT4ge1xuICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICcnO1xuXG4gIGNvbnN0IGVudiA9IGxvYWRFbnYoKSgpO1xuICBleHBlY3QoZW52KS50b0VxdWFsKHtcbiAgICByb290RGlyOiAnLicsXG4gICAgZW52OiAnZGV2ZWxvcG1lbnQnLFxuICAgIHByZWZpeDogJycsXG4gICAgYXNzZXRQYXRoOiAnL19zdGF0aWMnLFxuICAgIGJhc2VBc3NldFBhdGg6ICcvX3N0YXRpYycsXG4gICAgY2RuVXJsOiAnJyxcbiAgICB3ZWJwYWNrUHVibGljUGF0aDogJy9fc3RhdGljJyxcbiAgICBkYW5nZXJvdXNseUV4cG9zZVNvdXJjZU1hcHM6IGZhbHNlLFxuICB9KTtcbn0pO1xuXG50ZXN0KCdsb2FkRW52IG92ZXJyaWRlcycsICgpID0+IHtcbiAgcHJvY2Vzcy5lbnYuUk9PVF9ESVIgPSAndGVzdF9yb290X2Rpcic7XG4gIHByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ3Byb2R1Y3Rpb24nO1xuICBwcm9jZXNzLmVudi5ST1VURV9QUkVGSVggPSAndGVzdF9yb3V0ZV9wcmVmaXgnO1xuICBwcm9jZXNzLmVudi5GUkFNRVdPUktfU1RBVElDX0FTU0VUX1BBVEggPSAnL3Rlc3RfZnJhbWV3b3JrJztcbiAgcHJvY2Vzcy5lbnYuQ0ROX1VSTCA9ICd0ZXN0X2Nkbl91cmwnO1xuICBwcm9jZXNzLmVudi5EQU5HRVJPVVNMWV9FWFBPU0VfU09VUkNFX01BUFMgPSAndHJ1ZSc7XG5cbiAgY29uc3QgZW52ID0gbG9hZEVudigpKCk7XG4gIGV4cGVjdChlbnYpLnRvRXF1YWwoe1xuICAgIHJvb3REaXI6ICd0ZXN0X3Jvb3RfZGlyJyxcbiAgICBlbnY6ICdwcm9kdWN0aW9uJyxcbiAgICBwcmVmaXg6ICd0ZXN0X3JvdXRlX3ByZWZpeCcsXG4gICAgYXNzZXRQYXRoOiAndGVzdF9yb3V0ZV9wcmVmaXgvdGVzdF9mcmFtZXdvcmsnLFxuICAgIGJhc2VBc3NldFBhdGg6ICcvdGVzdF9mcmFtZXdvcmsnLFxuICAgIGNkblVybDogJ3Rlc3RfY2RuX3VybCcsXG4gICAgd2VicGFja1B1YmxpY1BhdGg6ICd0ZXN0X2Nkbl91cmwnLFxuICAgIGRhbmdlcm91c2x5RXhwb3NlU291cmNlTWFwczogdHJ1ZSxcbiAgfSk7XG5cbiAgcHJvY2Vzcy5lbnYuUk9PVF9ESVIgPSAnJztcbiAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAnJztcbiAgcHJvY2Vzcy5lbnYuUk9VVEVfUFJFRklYID0gJyc7XG4gIHByb2Nlc3MuZW52LkZSQU1FV09SS19TVEFUSUNfQVNTRVRfUEFUSCA9ICcnO1xuICBwcm9jZXNzLmVudi5DRE5fVVJMID0gJyc7XG59KTtcblxudGVzdCgnbG9hZEVudiB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICdMT0wnO1xuICBleHBlY3QobG9hZEVudikudG9UaHJvdygvSW52YWxpZCBOT0RFX0VOViBsb2FkZWQvKTtcbiAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAnJztcblxuICBwcm9jZXNzLmVudi5ST1VURV9QUkVGSVggPSAndGVzdC8nO1xuICBleHBlY3QobG9hZEVudikudG9UaHJvdygvUk9VVEVfUFJFRklYIG11c3Qgbm90IGVuZCB3aXRoIC8pO1xuICBwcm9jZXNzLmVudi5ST1VURV9QUkVGSVggPSAnJztcblxuICBwcm9jZXNzLmVudi5GUkFNRVdPUktfU1RBVElDX0FTU0VUX1BBVEggPSAndGVzdC8nO1xuICBleHBlY3QobG9hZEVudikudG9UaHJvdygvRlJBTUVXT1JLX1NUQVRJQ19BU1NFVF9QQVRIIG11c3Qgbm90IGVuZCB3aXRoIC8pO1xuICBwcm9jZXNzLmVudi5GUkFNRVdPUktfU1RBVElDX0FTU0VUX1BBVEggPSAnJztcblxuICBwcm9jZXNzLmVudi5DRE5fVVJMID0gJ3Rlc3QvJztcbiAgZXhwZWN0KGxvYWRFbnYpLnRvVGhyb3coL0NETl9VUkwgbXVzdCBub3QgZW5kIHdpdGggLyk7XG4gIHByb2Nlc3MuZW52LkNETl9VUkwgPSAnJztcbn0pO1xuIl0sIm1hcHBpbmdzIjoiOztBQU9BO0FBUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0FBLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxNQUFNO0VBQzdCQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsUUFBUSxHQUFHLEVBQUU7RUFFekIsTUFBTUQsR0FBRyxHQUFHLElBQUFFLGVBQU8sR0FBRSxFQUFFO0VBQ3ZCQyxNQUFNLENBQUNILEdBQUcsQ0FBQyxDQUFDSSxPQUFPLENBQUM7SUFDbEJDLE9BQU8sRUFBRSxHQUFHO0lBQ1pMLEdBQUcsRUFBRSxhQUFhO0lBQ2xCTSxNQUFN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
"use strict";

var _testHelper = require("./test-helper");
var _serverApp = _interopRequireDefault(require("../server-app"));
var _createPlugin = require("../create-plugin");
var _createToken = require("../create-token");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
const App = false ? ClientAppFactory() : (0, _serverApp.default)();
const TokenA = (0, _createToken.createToken)('TokenA');
const TokenB = (0, _createToken.createToken)('TokenB');
const TokenString = (0, _createToken.createToken)('TokenString');
function delay() {
  return new Promise(resolve => {
    setTimeout(resolve, 1);
  });
}
test('async render', async () => {
  let numRenders = 0;
  const element = 'hi';
  const renderFn = el => {
    expect(el).toBe(element);
    return delay().then(() => {
      numRenders++;
      return el;
    });
  };
  const app = new App(element, renderFn);
  const ctx = await (0, _testHelper.run)(app);
  expect(ctx.element).toBeTruthy();
  expect(ctx.rendered).toBe(element);
  expect(numRenders).toBe(1);
  expect(ctx.element).toBe(element);
});
test('sync render', async () => {
  let numRenders = 0;
  const element = 'hi';
  const renderFn = el => {
    numRenders++;
    expect(el).toBe(element);
    return el;
  };
  const app = new App(element, renderFn);
  const ctx = await (0, _testHelper.run)(app);
  expect(ctx.rendered).toBe(element);
  expect(numRenders).toBe(1);
  expect(ctx.element).toBe(element);
});
test('render plugin order', async () => {
  let numRenders = 0;
  const element = 'hi';
  let order = 0;
  const renderFn = el => {
    order++;
    expect(el).toBe(element);
    expect(order).toBe(3);
    return delay().then(() => {
      numRenders++;
      return el;
    });
  };
  const renderPlugin = (0, _createPlugin.createPlugin)({
    provides: () => renderFn,
    middleware: () => (ctx, next) => {
      order++;
      expect(ctx.element).toBe(element);
      expect(order).toBe(2);
      return next();
    }
  });
  // TODO(#137): fix flow types for renderPlugin
  const app = new App(element, renderPlugin);
  app.middleware((ctx, next) => {
    order++;
    expect(order).toBe(1);
    return next();
  });
  const ctx = await (0, _testHelper.run)(app);
  expect(ctx.element).toBeTruthy();
  expect(ctx.rendered).toBe(element);
  expect(numRenders).toBe(1);
  expect(ctx.element).toBe(element);
});
test('app.register - async render with async middleware', async () => {
  let numRenders = 0;
  const element = 'hi';
  const renderFn = el => {
    expect(el).toBe(element);
    return delay().then(() => {
      numRenders++;
      return el;
    });
  };
  const app = new App(element, renderFn);
  app.middleware(async (ctx, next) => {
    expect(ctx.element).toBe(element);
    expect(numRenders).toBe(0);
    expect(ctx.rendered).toBeFalsy();
    await next();
    expect(numRenders).toBe(1);
    expect(ctx.rendered).toBe(element);
  });
  const ctx = await (0, _testHelper.run)(app);
  expect(ctx.rendered).toBe(element);
  expect(numRenders).toBe(1);
  expect(ctx.element).toBe(element);
});
test('app.register - middleware execution respects registration order', async () => {
  let numRenders = 0;
  const element = 'hi';
  const renderFn = el => {
    expect(el).toBe(element);
    return delay().then(() => {
      numRenders++;
      return el;
    });
  };
  const app = new App(element, renderFn);
  let order = 0;
  app.middleware(async (ctx, next) => {
    expect(order).toBe(0);
    order++;
    expect(ctx.element).toBe(element);
    expect(numRenders).toBe(0);
    expect(ctx.rendered).toBeFalsy();
    await next();
    expect(order).toBe(3);
    expect(numRenders).toBe(1);
    expect(ctx.rendered).toBe(element);
    order++;
  });
  app.middleware(async (ctx, next) => {
    expect(order).toBe(1);
    order++;
    expect(ctx.element).toBe(element);
    expect(numRenders).toBe(0);
    expect(ctx.rendered).toBeFalsy();
    await next();
    expect(order).toBe(2);
    order++;
    expect(numRenders).toBe(1);
    expect(ctx.rendered).toBe(element);
  });
  const ctx = await (0, _testHelper.run)(app);
  expect(ctx.rendered).toBe(element);
  expect(numRenders).toBe(1);
  expect(order).toBe(4);
});
test('app.register - middleware execution respects dependency order', async () => {
  let numRenders = 0;
  const element = 'hi';
  const renderFn = el => {
    expect(el).toBe(element);
    return delay().then(() => {
      numRenders++;
      return el;
    });
  };
  const app = new App(element, renderFn);
  let order = 0;
  app.middleware(async function first(ctx, next) {
    expect(order).toBe(0);
    expect(numRenders).toBe(0);
    order++;
    await next();
    expect(order).toBe(7);
    expect(numRenders).toBe(1);
    order++;
  });
  app.register(TokenA, (0, _createPlugin.createPlugin)({
    deps: {
      TokenB
    },
    provides: deps => {
      expect(deps.TokenB().b).toBe('something-b');
      return {
        a: 'something'
      };
    },
    middleware: deps => {
      expect(deps.TokenB().b).toBe('something-b');
      return async function second(ctx, next) {
        expect(order).toBe(2);
        expect(numRenders).toBe(0);
        order++;
        await next();
        expect(order).toBe(5);
        expect(numRenders).toBe(1);
        order++;
      };
    }
  }));
  app.middleware(async function third(ctx, next) {
    expect(order).toBe(3);
    expect(numRenders).toBe(0);
    order++;
    await next();
    expect(order).toBe(4);
    expect(numRenders).toBe(1);
    order++;
  });
  app.register(TokenB, (0, _createPlugin.createPlugin)({
    provides: () => () => ({
      b: 'something-b'
    }),
    middleware: () => {
      return async function fourth(ctx, next) {
        expect(order).toBe(1);
        expect(numRenders).toBe(0);
        order++;
        await next();
        expect(order).toBe(6);
        expect(numRenders).toBe(1);
        order++;
      };
    }
  }));
  const ctx = await (0, _testHelper.run)(app);
  expect(ctx.rendered).toBe(element);
  expect(numRenders).toBe(1);
  expect(order).toBe(8);
});
test('app.middleware with dependencies', async () => {
  const element = 'hi';
  const renderFn = el => {
    return el;
  };
  const app = new App(element, renderFn);
  let called = false;
  app.register(TokenString, 'Something');
  app.middleware({
    TokenString
  }, deps => {
    expect(deps.TokenString).toBe('Something');
    return (ctx, next) => {
      called = true;
      return next();
    };
  });
  await (0, _testHelper.run)(app);
  expect(called).toBeTruthy();
});
test('app.middleware with no dependencies', async () => {
  const element = 'hi';
  const renderFn = el => {
    return el;
  };
  const app = new App(element, renderFn);
  let called = false;
  app.middleware((ctx, next) => {
    called = true;
    return next();
  });
  await (0, _testHelper.run)(app);
  expect(called).toBeTruthy();
});
true && test('ctx.respond as false', async () => {
  const element = 'hi';
  const renderFn = jest.fn();
  const app = new App(element, renderFn);
  app.middleware((ctx, next) => {
    ctx.respond = false;
    return next();
  });
  const ctx = await (0, _testHelper.run)(app);
  expect(renderFn).not.toHaveBeenCalled();
  expect(ctx.rendered).toBeFalsy();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcHAiLCJDbGllbnRBcHBGYWN0b3J5IiwiU2VydmVyQXBwRmFjdG9yeSIsIlRva2VuQSIsImNyZWF0ZVRva2VuIiwiVG9rZW5CIiwiVG9rZW5TdHJpbmciLCJkZWxheSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInRlc3QiLCJudW1SZW5kZXJzIiwiZWxlbWVudCIsInJlbmRlckZuIiwiZWwiLCJleHBlY3QiLCJ0b0JlIiwidGhlbiIsImFwcCIsImN0eCIsInJ1biIsInRvQmVUcnV0aHkiLCJyZW5kZXJlZCIsIm9yZGVyIiwicmVuZGVyUGx1Z2luIiwiY3JlYXRlUGx1Z2luIiwicHJvdmlkZXMiLCJtaWRkbGV3YXJlIiwibmV4dCIsInRvQmVGYWxzeSIsImZpcnN0IiwicmVnaXN0ZXIiLCJkZXBzIiwiYiIsImEiLCJzZWNvbmQiLCJ0aGlyZCIsImZvdXJ0aCIsImNhbGxlZCIsImplc3QiLCJmbiIsInJlc3BvbmQiLCJub3QiLCJ0b0hhdmVCZWVuQ2FsbGVkIl0sInNvdXJjZXMiOlsic3JjL19fdGVzdHNfXy9yZW5kZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtydW59IGZyb20gJy4vdGVzdC1oZWxwZXInO1xuaW1wb3J0IENsaWVudEFwcEZhY3RvcnkgZnJvbSAnLi4vY2xpZW50LWFwcCc7XG5pbXBvcnQgU2VydmVyQXBwRmFjdG9yeSBmcm9tICcuLi9zZXJ2ZXItYXBwJztcbmltcG9ydCB7Y3JlYXRlUGx1Z2lufSBmcm9tICcuLi9jcmVhdGUtcGx1Z2luJztcbmltcG9ydCB7Y3JlYXRlVG9rZW59IGZyb20gJy4uL2NyZWF0ZS10b2tlbic7XG5pbXBvcnQgdHlwZSB7VG9rZW59IGZyb20gJy4uL3R5cGVzJztcblxuY29uc3QgQXBwID0gX19CUk9XU0VSX18gPyBDbGllbnRBcHBGYWN0b3J5KCkgOiBTZXJ2ZXJBcHBGYWN0b3J5KCk7XG5cbnR5cGUgQVR5cGUgPSB7XG4gIGE6IHN0cmluZztcbn07XG5cbnR5cGUgQlR5cGUgPSAoKSA9PiB7XG4gIGI6IHN0cmluZztcbn07XG5cbmNvbnN0IFRva2VuQTogVG9rZW48QVR5cGU+ID0gY3JlYXRlVG9rZW4oJ1Rva2VuQScpO1xuY29uc3QgVG9rZW5COiBUb2tlbjxCVHlwZT4gPSBjcmVhdGVUb2tlbignVG9rZW5CJyk7XG5jb25zdCBUb2tlblN0cmluZzogVG9rZW48c3RyaW5nPiA9IGNyZWF0ZVRva2VuKCdUb2tlblN0cmluZycpO1xuXG5mdW5jdGlvbiBkZWxheSgpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgc2V0VGltZW91dChyZXNvbHZlLCAxKTtcbiAgfSk7XG59XG5cbnRlc3QoJ2FzeW5jIHJlbmRlcicsIGFzeW5jICgpID0+IHtcbiAgbGV0IG51bVJlbmRlcnMgPSAwO1xuICBjb25zdCBlbGVtZW50ID0gJ2hpJztcbiAgY29uc3QgcmVuZGVyRm4gPSAoZWwpID0+IHtcbiAgICBleHBlY3QoZWwpLnRvQmUoZWxlbWVudCk7XG4gICAgcmV0dXJuIGRlbGF5KCkudGhlbigoKSA9PiB7XG4gICAgICBudW1SZW5kZXJzKys7XG4gICAgICByZXR1cm4gZWw7XG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGFwcCA9IG5ldyBBcHAoZWxlbWVudCwgcmVuZGVyRm4pO1xuICBjb25zdCBjdHggPSBhd2FpdCBydW4oYXBwKTtcbiAgZXhwZWN0KGN0eC5lbGVtZW50KS50b0JlVHJ1dGh5KCk7XG4gIGV4cGVjdChjdHgucmVuZGVyZWQpLnRvQmUoZWxlbWVudCk7XG4gIGV4cGVjdChudW1SZW5kZXJzKS50b0JlKDEpO1xuICBleHBlY3QoY3R4LmVsZW1lbnQpLnRvQmUoZWxlbWVudCk7XG59KTtcblxudGVzdCgnc3luYyByZW5kZXInLCBhc3luYyAoKSA9PiB7XG4gIGxldCBudW1SZW5kZXJzID0gMDtcbiAgY29uc3QgZWxlbWVudCA9ICdoaSc7XG4gIGNvbnN0IHJlbmRlckZuID0gKGVsKSA9PiB7XG4gICAgbnVtUmVuZGVycysrO1xuICAgIGV4cGVjdChlbCkudG9CZShlbGVtZW50KTtcbiAgICByZXR1cm4gZWw7XG4gIH07XG4gIGNvbnN0IGFwcCA9IG5ldyBBcHAoZWxlbWVudCwgcmVuZGVyRm4pO1xuICBjb25zdCBjdHggPSBhd2FpdCBydW4oYXBwKTtcbiAgZXhwZWN0KGN0eC5yZW5kZXJlZCkudG9CZShlbGVtZW50KTtcbiAgZXhwZWN0KG51bVJlbmRlcnMpLnRvQmUoMSk7XG4gIGV4cGVjdChjdHguZWxlbWVudCkudG9CZShlbGVtZW50KTtcbn0pO1xuXG50ZXN0KCdyZW5kZXIgcGx1Z2luIG9yZGVyJywgYXN5bmMgKCkgPT4ge1xuICBsZXQgbnVtUmVuZGVycyA9IDA7XG4gIGNvbnN0IGVsZW1lbnQgPSAnaGknO1xuICBsZXQgb3JkZXIgPSAwO1xuICBjb25zdCByZW5kZXJGbiA9IChlbCkgPT4ge1xuICAgIG9yZGVyKys7XG4gICAgZXhwZWN0KGVsKS50b0JlKGVsZW1lbnQpO1xuICAgIGV4cGVjdChvcmRlcikudG9CZSgzKTtcbiAgICByZXR1cm4gZGVsYXkoKS50aGVuKCgpID0+IHtcbiAgICAgIG51bVJlbmRlcnMrKztcbiAgICAgIHJldHVybiBlbDtcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgcmVuZGVyUGx1Z2luID0gY3JlYXRlUGx1Z2luKHtcbiAgICBwcm92aWRlczogKCkgPT4gcmVuZGVyRm4sXG4gICAgbWlkZGxld2FyZTogKCkgPT4gKGN0eCwgbmV4dCkgPT4ge1xuICAgICAgb3JkZXIrKztcbiAgICAgIGV4cGVjdChjdHguZWxlbWVudCkudG9CZShlbGVtZW50KTtcbiAgICAgIGV4cGVjdChvcmRlcikudG9CZSgyKTtcbiAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgfSxcbiAgfSk7XG4gIC8vIFRPRE8oIzEzNyk6IGZpeCBmbG93IHR5cGVzIGZvciByZW5kZXJQbHVnaW5cbiAgY29uc3QgYXBwID0gbmV3IEFwcChlbGVtZW50LCByZW5kZXJQbHVnaW4pO1xuICBhcHAubWlkZGxld2FyZSgoY3R4LCBuZXh0KSA9PiB7XG4gICAgb3JkZXIrKztcbiAgICBleHBlY3Qob3JkZXIpLnRvQmUoMSk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSk7XG4gIGNvbnN0IGN0eCA9IGF3YWl0IHJ1bihhcHApO1xuICBleHBlY3QoY3R4LmVsZW1lbnQpLnRvQmVUcnV0aHkoKTtcbiAgZXhwZWN0KGN0eC5yZW5kZXJlZCkudG9CZShlbGVtZW50KTtcbiAgZXhwZWN0KG51bVJlbmRlcnMpLnRvQmUoMSk7XG4gIGV4cGVjdChjdHguZWxlbWVudCkudG9CZShlbGVtZW50KTtcbn0pO1xuXG50ZXN0KCdhcHAucmVnaXN0ZXIgLSBhc3luYyByZW5kZXIgd2l0aCBhc3luYyBtaWRkbGV3YXJlJywgYXN5bmMgKCkgPT4ge1xuICBsZXQgbnVtUmVuZGVycyA9IDA7XG4gIGNvbnN0IGVsZW1lbnQgPSAnaGknO1xuICBjb25zdCByZW5kZXJGbiA9IChlbCkgPT4ge1xuICAgIGV4cGVjdChlbCkudG9CZShlbGVtZW50KTtcbiAgICByZXR1cm4gZGVsYXkoKS50aGVuKCgpID0+IHtcbiAgICAgIG51bVJlbmRlcnMrKztcbiAgICAgIHJldHVybiBlbDtcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgYXBwID0gbmV3IEFwcChlbGVtZW50LCByZW5kZXJGbik7XG4gIGFwcC5taWRkbGV3YXJlKGFzeW5jIChjdHgsIG5leHQpID0+IHtcbiAgICBleHBlY3QoY3R4LmVsZW1lbnQpLnRvQmUoZWxlbWVudCk7XG4gICAgZXhwZWN0KG51bVJlbmRlcnMpLnRvQmUoMCk7XG4gICAgZXhwZWN0KGN0eC5yZW5kZXJlZCkudG9CZUZhbHN5KCk7XG4gICAgYXdhaXQgbmV4dCgpO1xuICAgIGV4cGVjdChudW1SZW5kZXJzKS50b0JlKDEpO1xuICAgIGV4cGVjdChjdHgucmVuZGVyZWQpLnRvQmUoZWxlbWVudCk7XG4gIH0pO1xuICBjb25zdCBjdHggPSBhd2FpdCBydW4oYXBwKTtcbiAgZXhwZWN0KGN0eC5yZW5kZXJlZCkudG9CZShlbGVtZW50KTtcbiAgZXhwZWN0KG51bVJlbmRlcnMpLnRvQmUoMSk7XG4gIGV4cGVjdChjdHguZWxlbWVudCkudG9CZShlbGVtZW50KTtcbn0pO1xuXG50ZXN0KCdhcHAucmVnaXN0ZXIgLSBtaWRkbGV3YXJlIGV4ZWN1dGlvbiByZXNwZWN0cyByZWdpc3RyYXRpb24gb3JkZXInLCBhc3luYyAoKSA9PiB7XG4gIGxldCBudW1SZW5kZXJzID0gMDtcbiAgY29uc3QgZWxlbWVudCA9ICdoaSc7XG4gIGNvbnN0IHJlbmRlckZuID0gKGVsKSA9PiB7XG4gICAgZXhwZWN0KGVsKS50b0JlKGVsZW1lbnQpO1xuICAgIHJldHVybiBkZWxheSgpLnRoZW4oKCkgPT4ge1xuICAgICAgbnVtUmVuZGVycysrO1xuICAgICAgcmV0dXJuIGVsO1xuICAgIH0pO1xuICB9O1xuICBjb25zdCBhcHAgPSBuZXcgQXBwKGVsZW1lbnQsIHJlbmRlckZuKTtcbiAgbGV0IG9yZGVyID0gMDtcbiAgYXBwLm1pZGRsZXdhcmUoYXN5bmMgKGN0eCwgbmV4dCkgPT4ge1xuICAgIGV4cGVjdChvcmRlcikudG9CZSgwKTtcbiAgICBvcmRlcisrO1xuICAgIGV4cGVjdChjdHguZWxlbWVudCkudG9CZShlbGVtZW50KTtcbiAgICBleHBlY3QobnVtUmVuZGVycykudG9CZSgwKTtcbiAgICBleHBlY3QoY3R4LnJlbmRlcmVkKS50b0JlRmFsc3koKTtcbiAgICBhd2FpdCBuZXh0KCk7XG4gICAgZXhwZWN0KG9yZGVyKS50b0JlKDMpO1xuICAgIGV4cGVjdChudW1SZW5kZXJzKS50b0JlKDEpO1xuICAgIGV4cGVjdChjdHgucmVuZGVyZWQpLnRvQmUoZWxlbWVudCk7XG4gICAgb3JkZXIrKztcbiAgfSk7XG4gIGFwcC5taWRkbGV3YXJlKGFzeW5jIChjdHgsIG5leHQpID0+IHtcbiAgICBleHBlY3Qob3JkZXIpLnRvQmUoMSk7XG4gICAgb3JkZXIrKztcbiAgICBleHBlY3QoY3R4LmVsZW1lbnQpLnRvQmUoZWxlbWVudCk7XG4gICAgZXhwZWN0KG51bVJlbmRlcnMpLnRvQmUoMCk7XG4gICAgZXhwZWN0KGN0eC5yZW5kZXJlZCkudG9CZUZhbHN5KCk7XG4gICAgYXdhaXQgbmV4dCgpO1xuICAgIGV4cGVjdChvcmRlcikudG9CZSgyKTtcbiAgICBvcmRlcisrO1xuICAgIGV4cGVjdChudW1SZW5kZXJzKS50b0JlKDEpO1xuICAgIGV4cGVjdChjdHgucmVuZGVyZWQpLnRvQmUoZWxlbWVudCk7XG4gIH0pO1xuICBjb25zdCBjdHggPSBhd2FpdCBydW4oYXBwKTtcbiAgZXhwZWN0KGN0eC5yZW5kZXJlZCkudG9CZShlbGVtZW50KTtcbiAgZXhwZWN0KG51bVJlbmRlcnMpLnRvQmUoMSk7XG4gIGV4cGVjdChvcmRlcikudG9CZSg0KTtcbn0pO1xuXG50ZXN0KCdhcHAucmVnaXN0ZXIgLSBtaWRkbGV3YXJlIGV4ZWN1dGlvbiByZXNwZWN0cyBkZXBlbmRlbmN5IG9yZGVyJywgYXN5bmMgKCkgPT4ge1xuICBsZXQgbnVtUmVuZGVycyA9IDA7XG4gIGNvbnN0IGVsZW1lbnQgPSAnaGknO1xuICBjb25zdCByZW5kZXJGbiA9IChlbCkgPT4ge1xuICAgIGV4cGVjdChlbCkudG9CZShlbGVtZW50KTtcbiAgICByZXR1cm4gZGVsYXkoKS50aGVuKCgpID0+IHtcbiAgICAgIG51bVJlbmRlcnMrKztcbiAgICAgIHJldHVybiBlbDtcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgYXBwID0gbmV3IEFwcChlbGVtZW50LCByZW5kZXJGbik7XG4gIGxldCBvcmRlciA9IDA7XG4gIGFwcC5taWRkbGV3YXJlKGFzeW5jIGZ1bmN0aW9uIGZpcnN0KGN0eCwgbmV4dCkge1xuICAgIGV4cGVjdChvcmRlcikudG9CZSgwKTtcbiAgICBleHBlY3QobnVtUmVuZGVycykudG9CZSgwKTtcbiAgICBvcmRlcisrO1xuICAgIGF3YWl0IG5leHQoKTtcbiAgICBleHBlY3Qob3JkZXIpLnRvQmUoNyk7XG4gICAgZXhwZWN0KG51bVJlbmRlcnMpLnRvQmUoMSk7XG4gICAgb3JkZXIrKztcbiAgfSk7XG4gIGFwcC5yZWdpc3RlcihcbiAgICBUb2tlbkEsXG4gICAgY3JlYXRlUGx1Z2luKHtcbiAgICAgIGRlcHM6IHtUb2tlbkJ9LFxuICAgICAgcHJvdmlkZXM6IChkZXBzKSA9PiB7XG4gICAgICAgIGV4cGVjdChkZXBzLlRva2VuQigpLmIpLnRvQmUoJ3NvbWV0aGluZy1iJyk7XG4gICAgICAgIHJldHVybiB7YTogJ3NvbWV0aGluZyd9O1xuICAgICAgfSxcbiAgICAgIG1pZGRsZXdhcmU6IChkZXBzKSA9PiB7XG4gICAgICAgIGV4cGVjdChkZXBzLlRva2VuQigpLmIpLnRvQmUoJ3NvbWV0aGluZy1iJyk7XG4gICAgICAgIHJldHVybiBhc3luYyBmdW5jdGlvbiBzZWNvbmQoY3R4LCBuZXh0KSB7XG4gICAgICAgICAgZXhwZWN0KG9yZGVyKS50b0JlKDIpO1xuICAgICAgICAgIGV4cGVjdChudW1SZW5kZXJzKS50b0JlKDApO1xuICAgICAgICAgIG9yZGVyKys7XG4gICAgICAgICAgYXdhaXQgbmV4dCgpO1xuICAgICAgICAgIGV4cGVjdChvcmRlcikudG9CZSg1KTtcbiAgICAgICAgICBleHBlY3QobnVtUmVuZGVycykudG9CZSgxKTtcbiAgICAgICAgICBvcmRlcisrO1xuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9KVxuICApO1xuICBhcHAubWlkZGxld2FyZShhc3luYyBmdW5jdGlvbiB0aGlyZChjdHgsIG5leHQpIHtcbiAgICBleHBlY3Qob3JkZXIpLnRvQmUoMyk7XG4gICAgZXhwZWN0KG51bVJlbmRlcnMpLnRvQmUoMCk7XG4gICAgb3JkZXIrKztcbiAgICBhd2FpdCBuZXh0KCk7XG4gICAgZXhwZWN0KG9yZGVyKS50b0JlKDQpO1xuICAgIGV4cGVjdChudW1SZW5kZXJzKS50b0JlKDEpO1xuICAgIG9yZGVyKys7XG4gIH0pO1xuICBhcHAucmVnaXN0ZXIoXG4gICAgVG9rZW5CLFxuICAgIGNyZWF0ZVBsdWdpbih7XG4gICAgICBwcm92aWRlczogKCkgPT4gKCkgPT4gKHtiOiAnc29tZXRoaW5nLWInfSksXG4gICAgICBtaWRkbGV3YXJlOiAoKSA9PiB7XG4gICAgICAgIHJldHVybiBhc3luYyBmdW5jdGlvbiBmb3VydGgoY3R4LCBuZXh0KSB7XG4gICAgICAgICAgZXhwZWN0KG9yZGVyKS50b0JlKDEpO1xuICAgICAgICAgIGV4cGVjdChudW1SZW5kZXJzKS50b0JlKDApO1xuICAgICAgICAgIG9yZGVyKys7XG4gICAgICAgICAgYXdhaXQgbmV4dCgpO1xuICAgICAgICAgIGV4cGVjdChvcmRlcikudG9CZSg2KTtcbiAgICAgICAgICBleHBlY3QobnVtUmVuZGVycykudG9CZSgxKTtcbiAgICAgICAgICBvcmRlcisrO1xuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9KVxuICApO1xuICBjb25zdCBjdHggPSBhd2FpdCBydW4oYXBwKTtcbiAgZXhwZWN0KGN0eC5yZW5kZXJlZCkudG9CZShlbGVtZW50KTtcbiAgZXhwZWN0KG51bVJlbmRlcnMpLnRvQmUoMSk7XG4gIGV4cGVjdChvcmRlcikudG9CZSg4KTtcbn0pO1xuXG50ZXN0KCdhcHAubWlkZGxld2FyZSB3aXRoIGRlcGVuZGVuY2llcycsIGFzeW5jICgpID0+IHtcbiAgY29uc3QgZWxlbWVudCA9ICdoaSc7XG4gIGNvbnN0IHJlbmRlckZuID0gKGVsKSA9PiB7XG4gICAgcmV0dXJuIGVsO1xuICB9O1xuICBjb25zdCBhcHAgPSBuZXcgQXBwKGVsZW1lbnQsIHJlbmRlckZuKTtcbiAgbGV0IGNhbGxlZCA9IGZhbHNlO1xuICBhcHAucmVnaXN0ZXIoVG9rZW5TdHJpbmcsICdTb21ldGhpbmcnKTtcbiAgYXBwLm1pZGRsZXdhcmUoe1Rva2VuU3RyaW5nfSwgKGRlcHMpID0+IHtcbiAgICBleHBlY3QoZGVwcy5Ub2tlblN0cmluZykudG9CZSgnU29tZXRoaW5nJyk7XG4gICAgcmV0dXJuIChjdHgsIG5leHQpID0+IHtcbiAgICAgIGNhbGxlZCA9IHRydWU7XG4gICAgICByZXR1cm4gbmV4dCgpO1xuICAgIH07XG4gIH0pO1xuICBhd2FpdCBydW4oYXBwKTtcbiAgZXhwZWN0KGNhbGxlZCkudG9CZVRydXRoeSgpO1xufSk7XG5cbnRlc3QoJ2FwcC5taWRkbGV3YXJlIHdpdGggbm8gZGVwZW5kZW5jaWVzJywgYXN5bmMgKCkgPT4ge1xuICBjb25zdCBlbGVtZW50ID0gJ2hpJztcbiAgY29uc3QgcmVuZGVyRm4gPSAoZWwpID0+IHtcbiAgICByZXR1cm4gZWw7XG4gIH07XG4gIGNvbnN0IGFwcCA9IG5ldyBBcHAoZWxlbWVudCwgcmVuZGVyRm4pO1xuICBsZXQgY2FsbGVkID0gZmFsc2U7XG4gIGFwcC5taWRkbGV3YXJlKChjdHgsIG5leHQpID0+IHtcbiAgICBjYWxsZWQgPSB0cnVlO1xuICAgIHJldHVybiBuZXh0KCk7XG4gIH0pO1xuICBhd2FpdCBydW4oYXBwKTtcbiAgZXhwZWN0KGNhbGxlZCkudG9CZVRydXRoeSgpO1xufSk7XG5cbl9fTk9ERV9fICYmXG4gIHRlc3QoJ2N0eC5yZXNwb25kIGFzIGZhbHNlJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGVsZW1lbnQgPSAnaGknO1xuXG4gICAgY29uc3QgcmVuZGVyRm4gPSBqZXN0LmZuKCk7XG5cbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKGVsZW1lbnQsIHJlbmRlckZuKTtcbiAgICBhcHAubWlkZGxld2FyZSgoY3R4LCBuZXh0KSA9PiB7XG4gICAgICBjdHgucmVzcG9uZCA9IGZhbHNlO1xuICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICB9KTtcbiAgICBjb25zdCBjdHggPSBhd2FpdCBydW4oYXBwKTtcbiAgICBleHBlY3QocmVuZGVyRm4pLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgZXhwZWN0KGN0eC5yZW5kZXJlZCkudG9CZUZhbHN5KCk7XG4gIH0pO1xuIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQTRDO0FBRzVDLE1BQU1BLEdBQUcsR0FBRyxRQUFjQyxnQkFBZ0IsRUFBRSxHQUFHLElBQUFDLGtCQUFnQixHQUFFO0FBVWpFLE1BQU1DLE1BQW9CLEdBQUcsSUFB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
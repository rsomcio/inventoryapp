"use strict";

var _clientApp = _interopRequireDefault(require("../client-app"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

const App = (0, _clientApp.default)();
test('app callback', async () => {
  let numRenders = 0;
  const element = 'hi';
  const render = el => {
    numRenders++;
    expect(el).toBe(element);
    return el;
  };
  const app = new App(element, render);
  const callback = app.callback();
  expect(typeof callback).toBe('function');
  const ctx = await callback();
  expect(ctx.rendered).toBe(element);
  expect(numRenders).toBe(1);
  expect(ctx.element).toBe(element);
});
test('throws rendering errors', async () => {
  const element = 'hi';
  const render = () => {
    return new Promise(() => {
      throw new Error('Test error');
    });
  };
  const app = new App(element, render);
  const callback = app.callback();
  await expect(callback()).rejects.toThrow('Test error');
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcHAiLCJBcHBGYWN0b3J5IiwidGVzdCIsIm51bVJlbmRlcnMiLCJlbGVtZW50IiwicmVuZGVyIiwiZWwiLCJleHBlY3QiLCJ0b0JlIiwiYXBwIiwiY2FsbGJhY2siLCJjdHgiLCJyZW5kZXJlZCIsIlByb21pc2UiLCJFcnJvciIsInJlamVjdHMiLCJ0b1Rocm93Il0sInNvdXJjZXMiOlsic3JjL19fdGVzdHNfXy9pbmRleC5icm93c2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBDb3B5cmlnaHQgKGMpIDIwMTggVWJlciBUZWNobm9sb2dpZXMsIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKi9cblxuaW1wb3J0IEFwcEZhY3RvcnkgZnJvbSAnLi4vY2xpZW50LWFwcCc7XG5cbmNvbnN0IEFwcCA9IEFwcEZhY3RvcnkoKTtcblxudGVzdCgnYXBwIGNhbGxiYWNrJywgYXN5bmMgKCkgPT4ge1xuICBsZXQgbnVtUmVuZGVycyA9IDA7XG4gIGNvbnN0IGVsZW1lbnQgPSAnaGknO1xuICBjb25zdCByZW5kZXIgPSAoZWwpID0+IHtcbiAgICBudW1SZW5kZXJzKys7XG4gICAgZXhwZWN0KGVsKS50b0JlKGVsZW1lbnQpO1xuICAgIHJldHVybiBlbDtcbiAgfTtcbiAgY29uc3QgYXBwID0gbmV3IEFwcChlbGVtZW50LCByZW5kZXIpO1xuICBjb25zdCBjYWxsYmFjayA9IGFwcC5jYWxsYmFjaygpO1xuICBleHBlY3QodHlwZW9mIGNhbGxiYWNrKS50b0JlKCdmdW5jdGlvbicpO1xuICBjb25zdCBjdHggPSBhd2FpdCBjYWxsYmFjaygpO1xuICBleHBlY3QoY3R4LnJlbmRlcmVkKS50b0JlKGVsZW1lbnQpO1xuICBleHBlY3QobnVtUmVuZGVycykudG9CZSgxKTtcbiAgZXhwZWN0KGN0eC5lbGVtZW50KS50b0JlKGVsZW1lbnQpO1xufSk7XG5cbnRlc3QoJ3Rocm93cyByZW5kZXJpbmcgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICBjb25zdCBlbGVtZW50ID0gJ2hpJztcbiAgY29uc3QgcmVuZGVyID0gKCkgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgoKSA9PiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKTtcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgYXBwID0gbmV3IEFwcChlbGVtZW50LCByZW5kZXIpO1xuICBjb25zdCBjYWxsYmFjayA9IGFwcC5jYWxsYmFjaygpO1xuXG4gIGF3YWl0IGV4cGVjdChjYWxsYmFjaygpKS5yZWplY3RzLnRvVGhyb3coJ1Rlc3QgZXJyb3InKTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiOztBQU9BO0FBQXVDO0FBUHZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFJQSxNQUFNQSxHQUFHLEdBQUcsSUFBQUMsa0JBQVUsR0FBRTtBQUV4QkMsSUFBSSxDQUFDLGNBQWMsRUFBRSxZQUFZO0VBQy9CLElBQUlDLFVBQVUsR0FBRyxDQUFDO0VBQ2xCLE1BQU1DLE9BQU8sR0FBRyxJQUFJO0VBQ3BCLE1BQU1DLE1BQU0sR0FBSUMsRUFBRSxJQUFLO0lBQ3JCSCxVQUFVLEVBQUU7SUFDWkksTUFBTSxDQUFDRCxFQUFFLENBQUMsQ0FBQ0UsSUFBSSxDQUFDSixPQUFPLENBQUM7SUFDeEIsT0FBT0UsRUFBRTtFQUNYLENBQUM7RUFDRCxNQUFNRyxHQUFHLEdBQUcsSUFBSVQsR0FBRyxDQUFDSSxPQUFPLEVBQUVDLE1BQU0sQ0FBQztFQUNwQyxNQUFNSyxRQUFRLEdBQUdELEdBQUcsQ0FBQ0MsUUFBUSxFQUFFO0VBQy9CSCxNQUFNLENBQUMsT0FBT0csUUFBUSxDQUFDLENBQUNGLElBQUksQ0FBQyxVQUFVLENBQUM7RUFDeEMsTUFBTUcsR0FBRyxHQUFHLE1BQU1ELFFBQVEsRUFBRTtFQUM1QkgsTUFBTSxDQUFDSSxHQUFHLENBQUNDLFFBQVEsQ0FBQyxDQUFDSixJQUFJLENBQUNKLE9BQU8sQ0FBQztFQUNsQ0csTUFBTSxDQUFDSixVQUFVLENBQUMsQ0FBQ0ssSUFBSSxDQUFDLENBQUMsQ0FBQztFQUMxQkQsTUFBTSxDQUFDSSxHQUFHLENBQUNQLE9BQU8sQ0FBQyxDQUFDSSxJQUFJLENBQUNKLE9BQU8sQ0FBQztBQUNuQyxDQUFDLENBQUM7QUFFRkYsSUFBSSxDQUFDLHlCQUF5QixFQUFFLFlBQVk7RUFDMUMsTUFBTUUsT0FBTyxHQUFHLElBQUk7RUFDcEIsTUFBTUMsTUFBTSxHQUFHLE1BQU07SUFDbkIsT0FBTyxJQUFJUSxPQUFPLENBQUMsTUFBTTtNQUN2QixNQUFNLElBQUlDLEtBQUssQ0FBQyxZQUFZLENBQUM7SUFDL0IsQ0FBQyxDQUFDO0VBQ0osQ0FBQztFQUNELE1BQU1MLEdBQUcsR0FBRyxJQUFJVCxHQUFHLENBQUNJLE9BQU8sRUFBRUMsTUFBTSxDQUFDO0VBQ3BDLE1BQU1LLFFBQVEsR0FBR0QsR0FBRyxDQUFDQyxRQUFRLEVBQUU7RUFFL0IsTUFBTUgsTUFBTSxDQUFDRyxRQUFRLEVBQUUsQ0FBQyxDQUFDSyxPQUFPLENBQUNDLE9BQU8sQ0FBQyxZQUFZLENBQUM7QUFDeEQsQ0FBQyxDQUFDIn0=
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createPlugin = createPlugin;
exports.declarePlugin = declarePlugin;
exports.getPluginFn = getPluginFn;
var _stackTrace = require("./stack-trace");
var _legacyCompat = require("./legacy-compat");
/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

function createPlugin(opts) {
  // Inject the legacy plugin properties for compatibiity purposes.
  // However, we should eventually get rid of these properties and possibly
  // instead just represent plugins as plain generator functions.
  return {
    ...opts,
    __plugin__: true,
    __fn__: (0, _legacyCompat.createPlugin)(opts),
    stack: (0, _stackTrace.captureStackTrace)(createPlugin)
  };
}
function declarePlugin(fn) {
  fn.__fplugin__ = true;
  return fn;
}
function getPluginFn(val) {
  if (val && val.__plugin__ && val.__fn__) {
    return val.__fn__;
  }
  if (val && val.__fplugin__) {
    return val;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjcmVhdGVQbHVnaW4iLCJvcHRzIiwiX19wbHVnaW5fXyIsIl9fZm5fXyIsImNvbXBhdENyZWF0ZVBsdWdpbiIsInN0YWNrIiwiY2FwdHVyZVN0YWNrVHJhY2UiLCJkZWNsYXJlUGx1Z2luIiwiZm4iLCJfX2ZwbHVnaW5fXyIsImdldFBsdWdpbkZuIiwidmFsIl0sInNvdXJjZXMiOlsic3JjL2NyZWF0ZS1wbHVnaW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIENvcHlyaWdodCAoYykgMjAxOCBVYmVyIFRlY2hub2xvZ2llcywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqL1xuXG5pbXBvcnQgdHlwZSB7RnVzaW9uUGx1Z2luLCBGdXNpb25QbHVnaW5EZXBzVHlwZX0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge2NhcHR1cmVTdGFja1RyYWNlfSBmcm9tICcuL3N0YWNrLXRyYWNlJztcbmltcG9ydCB7Y3JlYXRlUGx1Z2luIGFzIGNvbXBhdENyZWF0ZVBsdWdpbn0gZnJvbSAnLi9sZWdhY3ktY29tcGF0JztcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGZsb3d0eXBlL2dlbmVyaWMtc3BhY2luZ1xudHlwZSBGdXNpb25QbHVnaW5Ob0hpZGRlbjxURGVwcyBleHRlbmRzIEZ1c2lvblBsdWdpbkRlcHNUeXBlLCBUU2VydmljZT4gPSBPbWl0PFxuICBGdXNpb25QbHVnaW48VERlcHMsIFRTZXJ2aWNlPixcbiAgJ19fcGx1Z2luX18nIHwgJ3N0YWNrJyB8ICdfX2ZuX18nXG4+O1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUGx1Z2luPFxuICBURGVwcyBleHRlbmRzIEZ1c2lvblBsdWdpbkRlcHNUeXBlLFxuICBUU2VydmljZSBleHRlbmRzIGFueVxuPihvcHRzOiBGdXNpb25QbHVnaW5Ob0hpZGRlbjxURGVwcywgVFNlcnZpY2U+KTogRnVzaW9uUGx1Z2luPFREZXBzLCBUU2VydmljZT4ge1xuICAvLyBJbmplY3QgdGhlIGxlZ2FjeSBwbHVnaW4gcHJvcGVydGllcyBmb3IgY29tcGF0aWJpaXR5IHB1cnBvc2VzLlxuICAvLyBIb3dldmVyLCB3ZSBzaG91bGQgZXZlbnR1YWxseSBnZXQgcmlkIG9mIHRoZXNlIHByb3BlcnRpZXMgYW5kIHBvc3NpYmx5XG4gIC8vIGluc3RlYWQganVzdCByZXByZXNlbnQgcGx1Z2lucyBhcyBwbGFpbiBnZW5lcmF0b3IgZnVuY3Rpb25zLlxuICByZXR1cm4ge1xuICAgIC4uLm9wdHMsXG4gICAgX19wbHVnaW5fXzogdHJ1ZSxcbiAgICBfX2ZuX186IGNvbXBhdENyZWF0ZVBsdWdpbihvcHRzKSxcbiAgICBzdGFjazogY2FwdHVyZVN0YWNrVHJhY2UoY3JlYXRlUGx1Z2luKSxcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlY2xhcmVQbHVnaW4oZm4pIHtcbiAgZm4uX19mcGx1Z2luX18gPSB0cnVlO1xuICByZXR1cm4gZm47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQbHVnaW5Gbih2YWwpIHtcbiAgaWYgKHZhbCAmJiB2YWwuX19wbHVnaW5fXyAmJiB2YWwuX19mbl9fKSB7XG4gICAgcmV0dXJuIHZhbC5fX2ZuX187XG4gIH1cbiAgaWYgKHZhbCAmJiB2YWwuX19mcGx1Z2luX18pIHtcbiAgICByZXR1cm4gdmFsO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBUUE7QUFDQTtBQVRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFZTyxTQUFTQSxZQUFZLENBRzFCQyxJQUEyQyxFQUFpQztFQUM1RTtFQUNBO0VBQ0E7RUFDQSxPQUFPO0lBQ0wsR0FBR0EsSUFBSTtJQUNQQyxVQUFVLEVBQUUsSUFBSTtJQUNoQkMsTUFBTSxFQUFFLElBQUFDLDBCQUFrQixFQUFDSCxJQUFJLENBQUM7SUFDaENJLEtBQUssRUFBRSxJQUFBQyw2QkFBaUIsRUFBQ04sWUFBWTtFQUN2QyxDQUFDO0FBQ0g7QUFFTyxTQUFTTyxhQUFhLENBQUNDLEVBQUUsRUFBRTtFQUNoQ0EsRUFBRSxDQUFDQyxXQUFXLEdBQUcsSUFBSTtFQUNyQixPQUFPRCxFQUFFO0FBQ1g7QUFFTyxTQUFTRSxXQUFXLENBQUNDLEdBQUcsRUFBRTtFQUMvQixJQUFJQSxHQUFHLElBQUlBLEdBQUcsQ0FBQ1QsVUFBVSxJQUFJUyxHQUFHLENBQUNSLE1BQU0sRUFBRTtJQUN2QyxPQUFPUSxHQUFHLENBQUNSLE1BQU07RUFDbkI7RUFDQSxJQUFJUSxHQUFHLElBQUlBLEdBQUcsQ0FBQ0YsV0FBVyxFQUFFO0lBQzFCLE9BQU9FLEdBQUc7RUFDWjtBQUNGIn0=
/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

import { captureStackTrace } from './stack-trace';
export const TokenType = Object.freeze({
  Required: 0,
  Optional: 1
});
function Ref() {}
export class TokenImpl {
  constructor(name, ref) {
    this.name = name;
    this.ref = ref || new Ref();
    this.type = ref ? TokenType.Optional : TokenType.Required;
    this.stacks = [{
      type: 'token',
      stack: captureStackTrace(createToken)
    }];
    if (!ref) {
      this.optional = new TokenImpl(name, this.ref);
    }
  }
}
export function createToken(name) {
  return new TokenImpl(name);
}
export function getTokenRef(token) {
  if (token instanceof TokenImpl) {
    return token.ref;
  }
  return token;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjYXB0dXJlU3RhY2tUcmFjZSIsIlRva2VuVHlwZSIsIk9iamVjdCIsImZyZWV6ZSIsIlJlcXVpcmVkIiwiT3B0aW9uYWwiLCJSZWYiLCJUb2tlbkltcGwiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJyZWYiLCJ0eXBlIiwic3RhY2tzIiwic3RhY2siLCJjcmVhdGVUb2tlbiIsIm9wdGlvbmFsIiwiZ2V0VG9rZW5SZWYiLCJ0b2tlbiJdLCJzb3VyY2VzIjpbInNyYy9jcmVhdGUtdG9rZW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIENvcHlyaWdodCAoYykgMjAxOCBVYmVyIFRlY2hub2xvZ2llcywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqL1xuXG5pbXBvcnQgdHlwZSB7VG9rZW59IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHtjYXB0dXJlU3RhY2tUcmFjZX0gZnJvbSAnLi9zdGFjay10cmFjZSc7XG5cbmV4cG9ydCBjb25zdCBUb2tlblR5cGUgPSBPYmplY3QuZnJlZXplKHtcbiAgUmVxdWlyZWQ6IDAsXG4gIE9wdGlvbmFsOiAxLFxufSk7XG5mdW5jdGlvbiBSZWYoKSB7fVxuZXhwb3J0IGNsYXNzIFRva2VuSW1wbDxUUmVzb2x2ZWQ+IHtcbiAgbmFtZTogc3RyaW5nO1xuICByZWY6IHVua25vd247XG4gIHR5cGU6IHR5cGVvZiBUb2tlblR5cGVba2V5b2YgdHlwZW9mIFRva2VuVHlwZV07XG4gIG9wdGlvbmFsOiBUb2tlbkltcGw8VFJlc29sdmVkPiB8IHVuZGVmaW5lZDtcbiAgc3RhY2tzOiBBcnJheTx7XG4gICAgdHlwZTogJ3Rva2VuJyB8ICdyZWdpc3RlcicgfCAnZW5oYW5jZScgfCAnYWxpYXMtZnJvbScgfCAnYWxpYXMtdG8nO1xuICAgIHN0YWNrOiBzdHJpbmc7XG4gIH0+O1xuXG4gIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgcmVmPzogdW5rbm93bikge1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5yZWYgPSByZWYgfHwgbmV3IFJlZigpO1xuICAgIHRoaXMudHlwZSA9IHJlZiA/IFRva2VuVHlwZS5PcHRpb25hbCA6IFRva2VuVHlwZS5SZXF1aXJlZDtcbiAgICB0aGlzLnN0YWNrcyA9IFt7dHlwZTogJ3Rva2VuJywgc3RhY2s6IGNhcHR1cmVTdGFja1RyYWNlKGNyZWF0ZVRva2VuKX1dO1xuICAgIGlmICghcmVmKSB7XG4gICAgICB0aGlzLm9wdGlvbmFsID0gbmV3IFRva2VuSW1wbChuYW1lLCB0aGlzLnJlZik7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUb2tlbjxUUmVzb2x2ZWRUeXBlPihuYW1lOiBzdHJpbmcpOiBUb2tlbjxUUmVzb2x2ZWRUeXBlPiB7XG4gIHJldHVybiBuZXcgVG9rZW5JbXBsKG5hbWUpIGFzIGFueSBhcyBUb2tlbjxUUmVzb2x2ZWRUeXBlPjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRva2VuUmVmKHRva2VuKSB7XG4gIGlmICh0b2tlbiBpbnN0YW5jZW9mIFRva2VuSW1wbCkge1xuICAgIHJldHVybiB0b2tlbi5yZWY7XG4gIH1cbiAgcmV0dXJuIHRva2VuO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0EsU0FBUUEsaUJBQWlCLFFBQU8sZUFBZTtBQUUvQyxPQUFPLE1BQU1DLFNBQVMsR0FBR0MsTUFBTSxDQUFDQyxNQUFNLENBQUM7RUFDckNDLFFBQVEsRUFBRSxDQUFDO0VBQ1hDLFFBQVEsRUFBRTtBQUNaLENBQUMsQ0FBQztBQUNGLFNBQVNDLEdBQUcsR0FBRyxDQUFDO0FBQ2hCLE9BQU8sTUFBTUMsU0FBUyxDQUFZO0VBVWhDQyxXQUFXLENBQUNDLElBQVksRUFBRUMsR0FBYSxFQUFFO0lBQ3ZDLElBQUksQ0FBQ0QsSUFBSSxHQUFHQSxJQUFJO0lBQ2hCLElBQUksQ0FBQ0MsR0FBRyxHQUFHQSxHQUFHLElBQUksSUFBSUosR0FBRyxFQUFFO0lBQzNCLElBQUksQ0FBQ0ssSUFBSSxHQUFHRCxHQUFHLEdBQUdULFNBQVMsQ0FBQ0ksUUFBUSxHQUFHSixTQUFTLENBQUNHLFFBQVE7SUFDekQsSUFBSSxDQUFDUSxNQUFNLEdBQUcsQ0FBQztNQUFDRCxJQUFJLEVBQUUsT0FBTztNQUFFRSxLQUFLLEVBQUViLGlCQUFpQixDQUFDYyxXQUFXO0lBQUMsQ0FBQyxDQUFDO0lBQ3RFLElBQUksQ0FBQ0osR0FBRyxFQUFFO01BQ1IsSUFBSSxDQUFDSyxRQUFRLEdBQUcsSUFBSVIsU0FBUyxDQUFDRSxJQUFJLEVBQUUsSUFBSSxDQUFDQyxHQUFHLENBQUM7SUFDL0M7RUFDRjtBQUNGO0FBRUEsT0FBTyxTQUFTSSxXQUFXLENBQWdCTCxJQUFZLEVBQXdCO0VBQzdFLE9BQU8sSUFBSUYsU0FBUyxDQUFDRSxJQUFJLENBQUM7QUFDNUI7QUFFQSxPQUFPLFNBQVNPLFdBQVcsQ0FBQ0MsS0FBSyxFQUFFO0VBQ2pDLElBQUlBLEtBQUssWUFBWVYsU0FBUyxFQUFFO0lBQzlCLE9BQU9VLEtBQUssQ0FBQ1AsR0FBRztFQUNsQjtFQUNBLE9BQU9PLEtBQUs7QUFDZCJ9
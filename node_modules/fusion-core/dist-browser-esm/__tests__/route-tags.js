import ClientAppFactory from '../client-app';
import { run } from './test-helper';
import { RouteTagsToken } from '../tokens';
const App = true ? ClientAppFactory() : ServerAppFactory();
test('timing plugin', async () => {
  const element = 'hi';
  const renderFn = el => {
    return el;
  };
  const app = new App(element, renderFn);
  expect.assertions(4);
  app.middleware({
    RouteTags: RouteTagsToken
  }, ({
    RouteTags
  }) => async (ctx, next) => {
    const tags = RouteTags.from(ctx);
    expect(tags.name).toBe('unknown_route');
    await next();
    expect(tags.name).toBe('test');
    expect(tags.test).toBe('something');
  });
  app.middleware({
    RouteTags: RouteTagsToken
  }, ({
    RouteTags
  }) => (ctx, next) => {
    const tags = RouteTags.from(ctx);
    expect(tags.name).toBe('unknown_route');
    tags.name = 'test';
    tags.test = 'something';
    return next();
  });
  await run(app);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDbGllbnRBcHBGYWN0b3J5IiwicnVuIiwiUm91dGVUYWdzVG9rZW4iLCJBcHAiLCJTZXJ2ZXJBcHBGYWN0b3J5IiwidGVzdCIsImVsZW1lbnQiLCJyZW5kZXJGbiIsImVsIiwiYXBwIiwiZXhwZWN0IiwiYXNzZXJ0aW9ucyIsIm1pZGRsZXdhcmUiLCJSb3V0ZVRhZ3MiLCJjdHgiLCJuZXh0IiwidGFncyIsImZyb20iLCJuYW1lIiwidG9CZSJdLCJzb3VyY2VzIjpbInNyYy9fX3Rlc3RzX18vcm91dGUtdGFncy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2xpZW50QXBwRmFjdG9yeSBmcm9tICcuLi9jbGllbnQtYXBwJztcbmltcG9ydCBTZXJ2ZXJBcHBGYWN0b3J5IGZyb20gJy4uL3NlcnZlci1hcHAnO1xuaW1wb3J0IHtydW59IGZyb20gJy4vdGVzdC1oZWxwZXInO1xuaW1wb3J0IHtSb3V0ZVRhZ3NUb2tlbn0gZnJvbSAnLi4vdG9rZW5zJztcblxuY29uc3QgQXBwID0gX19CUk9XU0VSX18gPyBDbGllbnRBcHBGYWN0b3J5KCkgOiBTZXJ2ZXJBcHBGYWN0b3J5KCk7XG5cbnRlc3QoJ3RpbWluZyBwbHVnaW4nLCBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IGVsZW1lbnQgPSAnaGknO1xuICBjb25zdCByZW5kZXJGbiA9IChlbCkgPT4ge1xuICAgIHJldHVybiBlbDtcbiAgfTtcbiAgY29uc3QgYXBwID0gbmV3IEFwcChlbGVtZW50LCByZW5kZXJGbik7XG4gIGV4cGVjdC5hc3NlcnRpb25zKDQpO1xuICBhcHAubWlkZGxld2FyZShcbiAgICB7Um91dGVUYWdzOiBSb3V0ZVRhZ3NUb2tlbn0sXG4gICAgKHtSb3V0ZVRhZ3N9KSA9PlxuICAgICAgYXN5bmMgKGN0eCwgbmV4dCkgPT4ge1xuICAgICAgICBjb25zdCB0YWdzID0gUm91dGVUYWdzLmZyb20oY3R4KTtcbiAgICAgICAgZXhwZWN0KHRhZ3MubmFtZSkudG9CZSgndW5rbm93bl9yb3V0ZScpO1xuICAgICAgICBhd2FpdCBuZXh0KCk7XG4gICAgICAgIGV4cGVjdCh0YWdzLm5hbWUpLnRvQmUoJ3Rlc3QnKTtcbiAgICAgICAgZXhwZWN0KHRhZ3MudGVzdCkudG9CZSgnc29tZXRoaW5nJyk7XG4gICAgICB9XG4gICk7XG5cbiAgYXBwLm1pZGRsZXdhcmUoe1JvdXRlVGFnczogUm91dGVUYWdzVG9rZW59LCAoe1JvdXRlVGFnc30pID0+IChjdHgsIG5leHQpID0+IHtcbiAgICBjb25zdCB0YWdzID0gUm91dGVUYWdzLmZyb20oY3R4KTtcbiAgICBleHBlY3QodGFncy5uYW1lKS50b0JlKCd1bmtub3duX3JvdXRlJyk7XG4gICAgdGFncy5uYW1lID0gJ3Rlc3QnO1xuICAgIHRhZ3MudGVzdCA9ICdzb21ldGhpbmcnO1xuICAgIHJldHVybiBuZXh0KCk7XG4gIH0pO1xuICBhd2FpdCBydW4oYXBwKTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxPQUFPQSxnQkFBZ0IsTUFBTSxlQUFlO0FBRTVDLFNBQVFDLEdBQUcsUUFBTyxlQUFlO0FBQ2pDLFNBQVFDLGNBQWMsUUFBTyxXQUFXO0FBRXhDLE1BQU1DLEdBQUcsR0FBRyxPQUFjSCxnQkFBZ0IsRUFBRSxHQUFHSSxnQkFBZ0IsRUFBRTtBQUVqRUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxZQUFZO0VBQ2hDLE1BQU1DLE9BQU8sR0FBRyxJQUFJO0VBQ3BCLE1BQU1DLFFBQVEsR0FBSUMsRUFBRSxJQUFLO0lBQ3ZCLE9BQU9BLEVBQUU7RUFDWCxDQUFDO0VBQ0QsTUFBTUMsR0FBRyxHQUFHLElBQUlOLEdBQUcsQ0FBQ0csT0FBTyxFQUFFQyxRQUFRLENBQUM7RUFDdENHLE1BQU0sQ0FBQ0MsVUFBVSxDQUFDLENBQUMsQ0FBQztFQUNwQkYsR0FBRyxDQUFDRyxVQUFVLENBQ1o7SUFBQ0MsU0FBUyxFQUFFWDtFQUFjLENBQUMsRUFDM0IsQ0FBQztJQUFDVztFQUFTLENBQUMsS0FDVixPQUFPQyxHQUFHLEVBQUVDLElBQUksS0FBSztJQUNuQixNQUFNQyxJQUFJLEdBQUdILFNBQVMsQ0FBQ0ksSUFBSSxDQUFDSCxHQUFHLENBQUM7SUFDaENKLE1BQU0sQ0FBQ00sSUFBSSxDQUFDRSxJQUFJLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLGVBQWUsQ0FBQztJQUN2QyxNQUFNSixJQUFJLEVBQUU7SUFDWkwsTUFBTSxDQUFDTSxJQUFJLENBQUNFLElBQUksQ0FBQyxDQUFDQyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQzlCVCxNQUFNLENBQUNNLElBQUksQ0FBQ1gsSUFBSSxDQUFDLENBQUNjLElBQUksQ0FBQyxXQUFXLENBQUM7RUFDckMsQ0FBQyxDQUNKO0VBRURWLEdBQUcsQ0FBQ0csVUFBVSxDQUFDO0lBQUNDLFNBQVMsRUFBRVg7RUFBYyxDQUFDLEVBQUUsQ0FBQztJQUFDVztFQUFTLENBQUMsS0FBSyxDQUFDQyxHQUFHLEVBQUVDLElBQUksS0FBSztJQUMxRSxNQUFNQyxJQUFJLEdBQUdILFNBQVMsQ0FBQ0ksSUFBSSxDQUFDSCxHQUFHLENBQUM7SUFDaENKLE1BQU0sQ0FBQ00sSUFBSSxDQUFDRSxJQUFJLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLGVBQWUsQ0FBQztJQUN2Q0gsSUFBSSxDQUFDRSxJQUFJLEdBQUcsTUFBTTtJQUNsQkYsSUFBSSxDQUFDWCxJQUFJLEdBQUcsV0FBVztJQUN2QixPQUFPVSxJQUFJLEVBQUU7RUFDZixDQUFDLENBQUM7RUFDRixNQUFNZCxHQUFHLENBQUNRLEdBQUcsQ0FBQztBQUNoQixDQUFDLENBQUMifQ==
/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */
/* eslint-env node */
import { loadEnv } from '../get-env';
test('loadEnv defaults', () => {
  process.env.NODE_ENV = '';
  const env = loadEnv()();
  expect(env).toEqual({
    rootDir: '.',
    env: 'development',
    prefix: '',
    assetPath: '/_static',
    baseAssetPath: '/_static',
    cdnUrl: '',
    webpackPublicPath: '/_static',
    dangerouslyExposeSourceMaps: false
  });
});
test('loadEnv overrides', () => {
  process.env.ROOT_DIR = 'test_root_dir';
  process.env.NODE_ENV = 'production';
  process.env.ROUTE_PREFIX = 'test_route_prefix';
  process.env.FRAMEWORK_STATIC_ASSET_PATH = '/test_framework';
  process.env.CDN_URL = 'test_cdn_url';
  process.env.DANGEROUSLY_EXPOSE_SOURCE_MAPS = 'true';
  const env = loadEnv()();
  expect(env).toEqual({
    rootDir: 'test_root_dir',
    env: 'production',
    prefix: 'test_route_prefix',
    assetPath: 'test_route_prefix/test_framework',
    baseAssetPath: '/test_framework',
    cdnUrl: 'test_cdn_url',
    webpackPublicPath: 'test_cdn_url',
    dangerouslyExposeSourceMaps: true
  });
  process.env.ROOT_DIR = '';
  process.env.NODE_ENV = '';
  process.env.ROUTE_PREFIX = '';
  process.env.FRAMEWORK_STATIC_ASSET_PATH = '';
  process.env.CDN_URL = '';
});
test('loadEnv validation', () => {
  process.env.NODE_ENV = 'LOL';
  expect(loadEnv).toThrow(/Invalid NODE_ENV loaded/);
  process.env.NODE_ENV = '';
  process.env.ROUTE_PREFIX = 'test/';
  expect(loadEnv).toThrow(/ROUTE_PREFIX must not end with /);
  process.env.ROUTE_PREFIX = '';
  process.env.FRAMEWORK_STATIC_ASSET_PATH = 'test/';
  expect(loadEnv).toThrow(/FRAMEWORK_STATIC_ASSET_PATH must not end with /);
  process.env.FRAMEWORK_STATIC_ASSET_PATH = '';
  process.env.CDN_URL = 'test/';
  expect(loadEnv).toThrow(/CDN_URL must not end with /);
  process.env.CDN_URL = '';
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJsb2FkRW52IiwidGVzdCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImV4cGVjdCIsInRvRXF1YWwiLCJyb290RGlyIiwicHJlZml4IiwiYXNzZXRQYXRoIiwiYmFzZUFzc2V0UGF0aCIsImNkblVybCIsIndlYnBhY2tQdWJsaWNQYXRoIiwiZGFuZ2Vyb3VzbHlFeHBvc2VTb3VyY2VNYXBzIiwiUk9PVF9ESVIiLCJST1VURV9QUkVGSVgiLCJGUkFNRVdPUktfU1RBVElDX0FTU0VUX1BBVEgiLCJDRE5fVVJMIiwiREFOR0VST1VTTFlfRVhQT1NFX1NPVVJDRV9NQVBTIiwidG9UaHJvdyJdLCJzb3VyY2VzIjpbInNyYy9fX3Rlc3RzX18vZW52Lm5vZGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIENvcHlyaWdodCAoYykgMjAxOCBVYmVyIFRlY2hub2xvZ2llcywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqL1xuLyogZXNsaW50LWVudiBub2RlICovXG5pbXBvcnQge2xvYWRFbnZ9IGZyb20gJy4uL2dldC1lbnYnO1xuXG50ZXN0KCdsb2FkRW52IGRlZmF1bHRzJywgKCkgPT4ge1xuICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICcnO1xuXG4gIGNvbnN0IGVudiA9IGxvYWRFbnYoKSgpO1xuICBleHBlY3QoZW52KS50b0VxdWFsKHtcbiAgICByb290RGlyOiAnLicsXG4gICAgZW52OiAnZGV2ZWxvcG1lbnQnLFxuICAgIHByZWZpeDogJycsXG4gICAgYXNzZXRQYXRoOiAnL19zdGF0aWMnLFxuICAgIGJhc2VBc3NldFBhdGg6ICcvX3N0YXRpYycsXG4gICAgY2RuVXJsOiAnJyxcbiAgICB3ZWJwYWNrUHVibGljUGF0aDogJy9fc3RhdGljJyxcbiAgICBkYW5nZXJvdXNseUV4cG9zZVNvdXJjZU1hcHM6IGZhbHNlLFxuICB9KTtcbn0pO1xuXG50ZXN0KCdsb2FkRW52IG92ZXJyaWRlcycsICgpID0+IHtcbiAgcHJvY2Vzcy5lbnYuUk9PVF9ESVIgPSAndGVzdF9yb290X2Rpcic7XG4gIHByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ3Byb2R1Y3Rpb24nO1xuICBwcm9jZXNzLmVudi5ST1VURV9QUkVGSVggPSAndGVzdF9yb3V0ZV9wcmVmaXgnO1xuICBwcm9jZXNzLmVudi5GUkFNRVdPUktfU1RBVElDX0FTU0VUX1BBVEggPSAnL3Rlc3RfZnJhbWV3b3JrJztcbiAgcHJvY2Vzcy5lbnYuQ0ROX1VSTCA9ICd0ZXN0X2Nkbl91cmwnO1xuICBwcm9jZXNzLmVudi5EQU5HRVJPVVNMWV9FWFBPU0VfU09VUkNFX01BUFMgPSAndHJ1ZSc7XG5cbiAgY29uc3QgZW52ID0gbG9hZEVudigpKCk7XG4gIGV4cGVjdChlbnYpLnRvRXF1YWwoe1xuICAgIHJvb3REaXI6ICd0ZXN0X3Jvb3RfZGlyJyxcbiAgICBlbnY6ICdwcm9kdWN0aW9uJyxcbiAgICBwcmVmaXg6ICd0ZXN0X3JvdXRlX3ByZWZpeCcsXG4gICAgYXNzZXRQYXRoOiAndGVzdF9yb3V0ZV9wcmVmaXgvdGVzdF9mcmFtZXdvcmsnLFxuICAgIGJhc2VBc3NldFBhdGg6ICcvdGVzdF9mcmFtZXdvcmsnLFxuICAgIGNkblVybDogJ3Rlc3RfY2RuX3VybCcsXG4gICAgd2VicGFja1B1YmxpY1BhdGg6ICd0ZXN0X2Nkbl91cmwnLFxuICAgIGRhbmdlcm91c2x5RXhwb3NlU291cmNlTWFwczogdHJ1ZSxcbiAgfSk7XG5cbiAgcHJvY2Vzcy5lbnYuUk9PVF9ESVIgPSAnJztcbiAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAnJztcbiAgcHJvY2Vzcy5lbnYuUk9VVEVfUFJFRklYID0gJyc7XG4gIHByb2Nlc3MuZW52LkZSQU1FV09SS19TVEFUSUNfQVNTRVRfUEFUSCA9ICcnO1xuICBwcm9jZXNzLmVudi5DRE5fVVJMID0gJyc7XG59KTtcblxudGVzdCgnbG9hZEVudiB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICdMT0wnO1xuICBleHBlY3QobG9hZEVudikudG9UaHJvdygvSW52YWxpZCBOT0RFX0VOViBsb2FkZWQvKTtcbiAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAnJztcblxuICBwcm9jZXNzLmVudi5ST1VURV9QUkVGSVggPSAndGVzdC8nO1xuICBleHBlY3QobG9hZEVudikudG9UaHJvdygvUk9VVEVfUFJFRklYIG11c3Qgbm90IGVuZCB3aXRoIC8pO1xuICBwcm9jZXNzLmVudi5ST1VURV9QUkVGSVggPSAnJztcblxuICBwcm9jZXNzLmVudi5GUkFNRVdPUktfU1RBVElDX0FTU0VUX1BBVEggPSAndGVzdC8nO1xuICBleHBlY3QobG9hZEVudikudG9UaHJvdygvRlJBTUVXT1JLX1NUQVRJQ19BU1NFVF9QQVRIIG11c3Qgbm90IGVuZCB3aXRoIC8pO1xuICBwcm9jZXNzLmVudi5GUkFNRVdPUktfU1RBVElDX0FTU0VUX1BBVEggPSAnJztcblxuICBwcm9jZXNzLmVudi5DRE5fVVJMID0gJ3Rlc3QvJztcbiAgZXhwZWN0KGxvYWRFbnYpLnRvVGhyb3coL0NETl9VUkwgbXVzdCBub3QgZW5kIHdpdGggLyk7XG4gIHByb2Nlc3MuZW52LkNETl9VUkwgPSAnJztcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVFBLE9BQU8sUUFBTyxZQUFZO0FBRWxDQyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsTUFBTTtFQUM3QkMsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFFBQVEsR0FBRyxFQUFFO0VBRXpCLE1BQU1ELEdBQUcsR0FBR0gsT0FBTyxFQUFFLEVBQUU7RUFDdkJLLE1BQU0sQ0FBQ0YsR0FBRyxDQUFDLENBQUNHLE9BQU8sQ0FBQztJQUNsQkMsT0FBTyxFQUFFLEdBQUc7SUFDWkosR0FBRyxFQUFFLGFB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
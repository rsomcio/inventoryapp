"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.SSRDecider = void 0;
exports.default = createSSRPlugin;
var _createPlugin = require("../create-plugin");
var _sanitization = require("../sanitization");
var _tokens = require("../tokens");
var _appSymbol = require("../utils/app-symbol");
var _isBot = require("../utils/is-bot");
/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

const SSRDecider = (0, _createPlugin.createPlugin)({
  deps: {
    enableServerStreaming: _tokens.unstable_EnableServerStreamingToken.optional
  },
  provides: deps => {
    return ctx => {
      // If the request has one of these extensions, we assume it's not something that requires server-side rendering of virtual dom
      // TODO(#46): this check should probably look at the asset manifest to ensure asset 404s are handled correctly
      if (ctx.path.match(/\.(js|js\.map|gif|jpg|png|pdf|json|svg)$/)) return false;
      if ((0, _isBot.isBot)(ctx)) {
        return true;
      }

      // The Accept header is a good proxy for whether SSR should happen
      // Requesting an HTML page via the browser url bar generates a request with `text/html` in its Accept headers
      // XHR/fetch requests do not have `text/html` in the Accept headers
      if (!ctx.headers.accept) return false;
      if (!ctx.headers.accept.includes('text/html')) return false;
      return deps.enableServerStreaming ? 'stream' : true;
    };
  }
});
exports.SSRDecider = SSRDecider;
function createSSRPlugin(endpoints) {
  return function ssrMiddleware({
    element,
    ssrDecider,
    ssrBodyTemplate,
    ssrShellTemplate
  }) {
    return async function ssrMiddleware(ctx, next) {
      if (endpoints.has(ctx.path)) {
        return next();
      }
      if (!ssrDecider(ctx)) return next();
      const template = {
        htmlAttrs: {},
        bodyAttrs: {},
        title: '',
        head: [],
        body: []
      };
      ctx.element = element;
      ctx.rendered = '';
      ctx.template = template;
      ctx.type = 'text/html';
      if (ssrShellTemplate) {
        ctx.shellTemplate = ssrShellTemplate;
      }

      // If streaming, add effects to prepare boundary once it drops
      if (ssrDecider(ctx) === 'stream') {
        // @ts-expect-error todo(flow->ts) TS2538: Type 'unique symbol' cannot be used as an index type.
        const app = ctx[_appSymbol.appSymbol];
        // Reset in case it has been set
        app.prepareBoundary.reset();
        // Add boundary effect to run through all postPrepare effects once the
        // prepare boundary drops
        app.prepareBoundary.addEffect(() => {
          for (const effect of ctx.postPrepareEffects) {
            effect();
          }
        });
        // Add boundary effect to serialize any universalValues to head once the prepare
        // boundary drops
        app.prepareBoundary.addEffect(() => {
          ctx.template.head.push(getSerializedUniversalValues(ctx));
        });
      }
      await next();

      // Allow someone to override the ssr by setting ctx.body
      // This is especially useful for things like ctx.redirect
      if (ctx.body && ctx.respond !== false) {
        return;
      }
      ctx.template.head.push(getSerializedUniversalValues(ctx));
      if (ssrBodyTemplate) {
        ctx.body = ssrBodyTemplate(ctx);
      } else {
        ctx.body = legacySSRBodyTemplate(ctx);
      }
    };
  };
}
function legacySSRBodyTemplate(ctx) {
  const {
    htmlAttrs,
    bodyAttrs,
    title,
    head,
    body
  } = ctx.template;
  const safeAttrs = Object.keys(htmlAttrs).map(attrKey => {
    return ` ${(0, _sanitization.escape)(attrKey)}="${(0, _sanitization.escape)(htmlAttrs[attrKey])}"`;
  }).join('');
  const safeBodyAttrs = Object.keys(bodyAttrs).map(attrKey => {
    return ` ${(0, _sanitization.escape)(attrKey)}="${(0, _sanitization.escape)(bodyAttrs[attrKey])}"`;
  }).join('');
  const safeTitle = (0, _sanitization.escape)(title);
  const safeHead = head.map(_sanitization.consumeSanitizedHTML).join('');
  const safeBody = body.map(_sanitization.consumeSanitizedHTML).join('');
  const preloadHintLinks = getPreloadHintLinks(ctx);
  const coreGlobals = getCoreGlobals(ctx);
  const chunkScripts = getChunkScripts(ctx);
  const bundleSplittingBootstrap = [preloadHintLinks, coreGlobals, chunkScripts].join('');
  return ['<!doctype html>', `<html${safeAttrs}>`, `<head>`, `<meta charset="utf-8" />`, `<title>${safeTitle}</title>`, `${bundleSplittingBootstrap}${safeHead}`, `</head>`, `<body${safeBodyAttrs}>${ctx.rendered}${safeBody}</body>`, '</html>'].join('');
}
function getCoreGlobals(ctx) {
  const {
    webpackPublicPath,
    nonce
  } = ctx;
  return [`<script nonce="${nonce}">`, `window.performance && window.performance.mark && window.performance.mark('firstRenderStart');`, `__ROUTE_PREFIX__ = ${JSON.stringify(ctx.prefix)};`,
  // consumed by ./client
  `__WEBPACK_PUBLIC_PATH__ = ${JSON.stringify(webpackPublicPath)};`,
  // consumed by fusion-clientries/client-entry
  `</script>`].join('');
}
function getUrls({
  chunkUrlMap,
  webpackPublicPath
}, chunks) {
  // cross origin is needed to get meaningful errors in window.onerror
  const isCrossOrigin = webpackPublicPath.startsWith('http');
  const crossOriginAttribute = isCrossOrigin ? ' crossorigin="anonymous"' : '';
  return [...new Set(chunks)].map(id => {
    let url = chunkUrlMap.get(id).get('es5');
    if (webpackPublicPath.endsWith('/')) {
      url = webpackPublicPath + url;
    } else {
      url = webpackPublicPath + '/' + url;
    }
    return {
      url,
      crossOriginAttribute
    };
  });
}
function getChunkScripts(ctx) {
  const sync = getUrls(ctx, ctx.syncChunks).map(({
    url,
    crossOriginAttribute
  }) => {
    return `<script nonce="${ctx.nonce}" defer${crossOriginAttribute} src="${url}"></script>`;
  });
  const preloaded = getUrls(ctx, ctx.preloadChunks.filter(item => !ctx.syncChunks.includes(item))).map(({
    url,
    crossOriginAttribute
  }) => {
    return `<script nonce="${ctx.nonce}" defer${crossOriginAttribute} src="${url}"></script>`;
  });
  return [...preloaded, ...sync].join('');
}
function getPreloadHintLinks(ctx) {
  const chunks = [...ctx.preloadChunks, ...ctx.syncChunks];
  const hints = getUrls(ctx, chunks).map(({
    url,
    crossOriginAttribute
  }) => {
    return `<link rel="preload"${crossOriginAttribute} href="${url}" nonce="${ctx.nonce}" as="script" />`;
  });
  return hints.join('');
}
function getSerializedUniversalValues(ctx) {
  const app = ctx[_appSymbol.appSymbol];
  return (0, _sanitization.html)`<script type="application/json" id="__FUSION_UNIVERSAL_VALUES__">
    ${JSON.stringify({
    ...app.universalValues,
    ...ctx.universalValues
  })}
  </script>`;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTU1JEZWNpZGVyIiwiY3JlYXRlUGx1Z2luIiwiZGVwcyIsImVuYWJsZVNlcnZlclN0cmVhbWluZyIsInVuc3RhYmxlX0VuYWJsZVNlcnZlclN0cmVhbWluZ1Rva2VuIiwib3B0aW9uYWwiLCJwcm92aWRlcyIsImN0eCIsInBhdGgiLCJtYXRjaCIsImlzQm90IiwiaGVhZGVycyIsImFjY2VwdCIsImluY2x1ZGVzIiwiY3JlYXRlU1NSUGx1Z2luIiwiZW5kcG9pbnRzIiwic3NyTWlkZGxld2FyZSIsImVsZW1lbnQiLCJzc3JEZWNpZGVyIiwic3NyQm9keVRlbXBsYXRlIiwic3NyU2hlbGxUZW1wbGF0ZSIsIm5leHQiLCJoYXMiLCJ0ZW1wbGF0ZSIsImh0bWxBdHRycyIsImJvZHlBdHRycyIsInRpdGxlIiwiaGVhZCIsImJvZHkiLCJyZW5kZXJlZCIsInR5cGUiLCJzaGVsbFRlbXBsYXRlIiwiYXBwIiwiYXBwU3ltYm9sIiwicHJlcGFyZUJvdW5kYXJ5IiwicmVzZXQiLCJhZGRFZmZlY3QiLCJlZmZlY3QiLCJwb3N0UHJlcGFyZUVmZmVjdHMiLCJwdXNoIiwiZ2V0U2VyaWFsaXplZFVuaXZlcnNhbFZhbHVlcyIsInJlc3BvbmQiLCJsZWdhY3lTU1JCb2R5VGVtcGxhdGUiLCJzYWZlQXR0cnMiLCJPYmplY3QiLCJrZXlzIiwibWFwIiwiYXR0cktleSIsImVzY2FwZSIsImpvaW4iLCJzYWZlQm9keUF0dHJzIiwic2FmZVRpdGxlIiwic2FmZUhlYWQiLCJjb25zdW1lU2FuaXRpemVkSFRNTCIsInNhZmVCb2R5IiwicHJlbG9hZEhpbnRMaW5rcyIsImdldFByZWxvYWRIaW50TGlua3MiLCJjb3JlR2xvYmFscyIsImdldENvcmVHbG9iYWxzIiwiY2h1bmtTY3JpcHRzIiwiZ2V0Q2h1bmtTY3JpcHRzIiwiYnVuZGxlU3BsaXR0aW5nQm9vdHN0cmFwIiwid2VicGFja1B1YmxpY1BhdGgiLCJub25jZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcmVmaXgiLCJnZXRVcmxzIiwiY2h1bmtVcmxNYXAiLCJjaHVua3MiLCJpc0Nyb3NzT3JpZ2luIiwic3RhcnRzV2l0aCIsImNyb3NzT3JpZ2luQXR0cmlidXRlIiwiU2V0IiwiaWQiLCJ1cmwiLCJnZXQiLCJlbmRzV2l0aCIsInN5bmMiLCJzeW5jQ2h1bmtzIiwicHJlbG9hZGVkIiwicHJlbG9hZENodW5rcyIsImZpbHRlciIsIml0ZW0iLCJoaW50cyIsImh0bWwiLCJ1bml2ZXJzYWxWYWx1ZXMiXSwic291cmNlcyI6WyJzcmMvcGx1Z2lucy9zc3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIENvcHlyaWdodCAoYykgMjAxOCBVYmVyIFRlY2hub2xvZ2llcywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqL1xuXG5pbXBvcnQge2NyZWF0ZVBsdWdpbn0gZnJvbSAnLi4vY3JlYXRlLXBsdWdpbic7XG5pbXBvcnQge2VzY2FwZSwgY29uc3VtZVNhbml0aXplZEhUTUwsIGh0bWx9IGZyb20gJy4uL3Nhbml0aXphdGlvbic7XG5pbXBvcnQge3Vuc3RhYmxlX0VuYWJsZVNlcnZlclN0cmVhbWluZ1Rva2VufSBmcm9tICcuLi90b2tlbnMnO1xuaW1wb3J0IHthcHBTeW1ib2x9IGZyb20gJy4uL3V0aWxzL2FwcC1zeW1ib2wnO1xuaW1wb3J0IHtpc0JvdH0gZnJvbSAnLi4vdXRpbHMvaXMtYm90JztcbmltcG9ydCB0eXBlIHtcbiAgQ29udGV4dCxcbiAgU1NSRGVjaWRlciBhcyBTU1JEZWNpZGVyU2VydmljZSxcbiAgU1NSQm9keVRlbXBsYXRlIGFzIFNTUkJvZHlUZW1wbGF0ZVNlcnZpY2UsXG59IGZyb20gJy4uL3R5cGVzJztcblxuY29uc3QgU1NSRGVjaWRlciA9IGNyZWF0ZVBsdWdpbih7XG4gIGRlcHM6IHtcbiAgICBlbmFibGVTZXJ2ZXJTdHJlYW1pbmc6IHVuc3RhYmxlX0VuYWJsZVNlcnZlclN0cmVhbWluZ1Rva2VuLm9wdGlvbmFsLFxuICB9LFxuICBwcm92aWRlczogKGRlcHMpOiBTU1JEZWNpZGVyU2VydmljZSA9PiB7XG4gICAgcmV0dXJuIChjdHgpID0+IHtcbiAgICAgIC8vIElmIHRoZSByZXF1ZXN0IGhhcyBvbmUgb2YgdGhlc2UgZXh0ZW5zaW9ucywgd2UgYXNzdW1lIGl0J3Mgbm90IHNvbWV0aGluZyB0aGF0IHJlcXVpcmVzIHNlcnZlci1zaWRlIHJlbmRlcmluZyBvZiB2aXJ0dWFsIGRvbVxuICAgICAgLy8gVE9ETygjNDYpOiB0aGlzIGNoZWNrIHNob3VsZCBwcm9iYWJseSBsb29rIGF0IHRoZSBhc3NldCBtYW5pZmVzdCB0byBlbnN1cmUgYXNzZXQgNDA0cyBhcmUgaGFuZGxlZCBjb3JyZWN0bHlcbiAgICAgIGlmIChjdHgucGF0aC5tYXRjaCgvXFwuKGpzfGpzXFwubWFwfGdpZnxqcGd8cG5nfHBkZnxqc29ufHN2ZykkLykpXG4gICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgaWYgKGlzQm90KGN0eCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIC8vIFRoZSBBY2NlcHQgaGVhZGVyIGlzIGEgZ29vZCBwcm94eSBmb3Igd2hldGhlciBTU1Igc2hvdWxkIGhhcHBlblxuICAgICAgLy8gUmVxdWVzdGluZyBhbiBIVE1MIHBhZ2UgdmlhIHRoZSBicm93c2VyIHVybCBiYXIgZ2VuZXJhdGVzIGEgcmVxdWVzdCB3aXRoIGB0ZXh0L2h0bWxgIGluIGl0cyBBY2NlcHQgaGVhZGVyc1xuICAgICAgLy8gWEhSL2ZldGNoIHJlcXVlc3RzIGRvIG5vdCBoYXZlIGB0ZXh0L2h0bWxgIGluIHRoZSBBY2NlcHQgaGVhZGVyc1xuICAgICAgaWYgKCFjdHguaGVhZGVycy5hY2NlcHQpIHJldHVybiBmYWxzZTtcbiAgICAgIGlmICghY3R4LmhlYWRlcnMuYWNjZXB0LmluY2x1ZGVzKCd0ZXh0L2h0bWwnKSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICByZXR1cm4gZGVwcy5lbmFibGVTZXJ2ZXJTdHJlYW1pbmcgPyAnc3RyZWFtJyA6IHRydWU7XG4gICAgfTtcbiAgfSxcbn0pO1xuXG5leHBvcnQge1NTUkRlY2lkZXJ9O1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjcmVhdGVTU1JQbHVnaW4oZW5kcG9pbnRzKSB7XG4gIHJldHVybiBmdW5jdGlvbiBzc3JNaWRkbGV3YXJlKHtcbiAgICBlbGVtZW50LFxuICAgIHNzckRlY2lkZXIsXG4gICAgc3NyQm9keVRlbXBsYXRlLFxuICAgIHNzclNoZWxsVGVtcGxhdGUsXG4gIH06IHtcbiAgICBlbGVtZW50OiBhbnk7XG4gICAgc3NyRGVjaWRlcjogU1NSRGVjaWRlclNlcnZpY2U7XG4gICAgc3NyQm9keVRlbXBsYXRlPzogU1NSQm9keVRlbXBsYXRlU2VydmljZTtcbiAgICBzc3JTaGVsbFRlbXBsYXRlOiBhbnk7XG4gIH0pIHtcbiAgICByZXR1cm4gYXN5bmMgZnVuY3Rpb24gc3NyTWlkZGxld2FyZShcbiAgICAgIGN0eDogQ29udGV4dCxcbiAgICAgIG5leHQ6ICgpID0+IFByb21pc2U8dm9pZD5cbiAgICApIHtcbiAgICAgIGlmIChlbmRwb2ludHMuaGFzKGN0eC5wYXRoKSkge1xuICAgICAgICByZXR1cm4gbmV4dCgpO1xuICAgICAgfVxuICAgICAgaWYgKCFzc3JEZWNpZGVyKGN0eCkpIHJldHVybiBuZXh0KCk7XG5cbiAgICAgIGNvbnN0IHRlbXBsYXRlID0ge1xuICAgICAgICBodG1sQXR0cnM6IHt9LFxuICAgICAgICBib2R5QXR0cnM6IHt9LFxuICAgICAgICB0aXRsZTogJycsXG4gICAgICAgIGhlYWQ6IFtdLFxuICAgICAgICBib2R5OiBbXSxcbiAgICAgIH07XG4gICAgICBjdHguZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICBjdHgucmVuZGVyZWQgPSAnJztcbiAgICAgIGN0eC50ZW1wbGF0ZSA9IHRlbXBsYXRlO1xuICAgICAgY3R4LnR5cGUgPSAndGV4dC9odG1sJztcbiAgICAgIGlmIChzc3JTaGVsbFRlbXBsYXRlKSB7XG4gICAgICAgIGN0eC5zaGVsbFRlbXBsYXRlID0gc3NyU2hlbGxUZW1wbGF0ZTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgc3RyZWFtaW5nLCBhZGQgZWZmZWN0cyB0byBwcmVwYXJlIGJvdW5kYXJ5IG9uY2UgaXQgZHJvcHNcbiAgICAgIGlmIChzc3JEZWNpZGVyKGN0eCkgPT09ICdzdHJlYW0nKSB7XG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgdG9kbyhmbG93LT50cykgVFMyNTM4OiBUeXBlICd1bmlxdWUgc3ltYm9sJyBjYW5ub3QgYmUgdXNlZCBhcyBhbiBpbmRleCB0eXBlLlxuICAgICAgICBjb25zdCBhcHAgPSBjdHhbYXBwU3ltYm9sXTtcbiAgICAgICAgLy8gUmVzZXQgaW4gY2FzZSBpdCBoYXMgYmVlbiBzZXRcbiAgICAgICAgYXBwLnByZXBhcmVCb3VuZGFyeS5yZXNldCgpO1xuICAgICAgICAvLyBBZGQgYm91bmRhcnkgZWZmZWN0IHRvIHJ1biB0aHJvdWdoIGFsbCBwb3N0UHJlcGFyZSBlZmZlY3RzIG9uY2UgdGhlXG4gICAgICAgIC8vIHByZXBhcmUgYm91bmRhcnkgZHJvcHNcbiAgICAgICAgYXBwLnByZXBhcmVCb3VuZGFyeS5hZGRFZmZlY3QoKCkgPT4ge1xuICAgICAgICAgIGZvciAoY29uc3QgZWZmZWN0IG9mIGN0eC5wb3N0UHJlcGFyZUVmZmVjdHMpIHtcbiAgICAgICAgICAgIGVmZmVjdCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIEFkZCBib3VuZGFyeSBlZmZlY3QgdG8gc2VyaWFsaXplIGFueSB1bml2ZXJzYWxWYWx1ZXMgdG8gaGVhZCBvbmNlIHRoZSBwcmVwYXJlXG4gICAgICAgIC8vIGJvdW5kYXJ5IGRyb3BzXG4gICAgICAgIGFwcC5wcmVwYXJlQm91bmRhcnkuYWRkRWZmZWN0KCgpID0+IHtcbiAgICAgICAgICBjdHgudGVtcGxhdGUuaGVhZC5wdXNoKGdldFNlcmlhbGl6ZWRVbml2ZXJzYWxWYWx1ZXMoY3R4KSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCBuZXh0KCk7XG5cbiAgICAgIC8vIEFsbG93IHNvbWVvbmUgdG8gb3ZlcnJpZGUgdGhlIHNzciBieSBzZXR0aW5nIGN0eC5ib2R5XG4gICAgICAvLyBUaGlzIGlzIGVzcGVjaWFsbHkgdXNlZnVsIGZvciB0aGluZ3MgbGlrZSBjdHgucmVkaXJlY3RcbiAgICAgIGlmIChjdHguYm9keSAmJiBjdHgucmVzcG9uZCAhPT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjdHgudGVtcGxhdGUuaGVhZC5wdXNoKGdldFNlcmlhbGl6ZWRVbml2ZXJzYWxWYWx1ZXMoY3R4KSk7XG5cbiAgICAgIGlmIChzc3JCb2R5VGVtcGxhdGUpIHtcbiAgICAgICAgY3R4LmJvZHkgPSBzc3JCb2R5VGVtcGxhdGUoY3R4KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN0eC5ib2R5ID0gbGVnYWN5U1NSQm9keVRlbXBsYXRlKGN0eCk7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gbGVnYWN5U1NSQm9keVRlbXBsYXRlKGN0eCkge1xuICBjb25zdCB7aHRtbEF0dHJzLCBib2R5QXR0cnMsIHRpdGxlLCBoZWFkLCBib2R5fSA9IGN0eC50ZW1wbGF0ZTtcbiAgY29uc3Qgc2FmZUF0dHJzID0gT2JqZWN0LmtleXMoaHRtbEF0dHJzKVxuICAgIC5tYXAoKGF0dHJLZXkpID0+IHtcbiAgICAgIHJldHVybiBgICR7ZXNjYXBlKGF0dHJLZXkpfT1cIiR7ZXNjYXBlKGh0bWxBdHRyc1thdHRyS2V5XSl9XCJgO1xuICAgIH0pXG4gICAgLmpvaW4oJycpO1xuXG4gIGNvbnN0IHNhZmVCb2R5QXR0cnMgPSBPYmplY3Qua2V5cyhib2R5QXR0cnMpXG4gICAgLm1hcCgoYXR0cktleSkgPT4ge1xuICAgICAgcmV0dXJuIGAgJHtlc2NhcGUoYXR0cktleSl9PVwiJHtlc2NhcGUoYm9keUF0dHJzW2F0dHJLZXldKX1cImA7XG4gICAgfSlcbiAgICAuam9pbignJyk7XG5cbiAgY29uc3Qgc2FmZVRpdGxlID0gZXNjYXBlKHRpdGxlKTtcbiAgY29uc3Qgc2FmZUhlYWQgPSBoZWFkLm1hcChjb25zdW1lU2FuaXRpemVkSFRNTCkuam9pbignJyk7XG4gIGNvbnN0IHNhZmVCb2R5ID0gYm9keS5tYXAoY29uc3VtZVNhbml0aXplZEhUTUwpLmpvaW4oJycpO1xuXG4gIGNvbnN0IHByZWxvYWRIaW50TGlua3MgPSBnZXRQcmVsb2FkSGludExpbmtzKGN0eCk7XG4gIGNvbnN0IGNvcmVHbG9iYWxzID0gZ2V0Q29yZUdsb2JhbHMoY3R4KTtcbiAgY29uc3QgY2h1bmtTY3JpcHRzID0gZ2V0Q2h1bmtTY3JpcHRzKGN0eCk7XG4gIGNvbnN0IGJ1bmRsZVNwbGl0dGluZ0Jvb3RzdHJhcCA9IFtcbiAgICBwcmVsb2FkSGludExpbmtzLFxuICAgIGNvcmVHbG9iYWxzLFxuICAgIGNodW5rU2NyaXB0cyxcbiAgXS5qb2luKCcnKTtcblxuICByZXR1cm4gW1xuICAgICc8IWRvY3R5cGUgaHRtbD4nLFxuICAgIGA8aHRtbCR7c2FmZUF0dHJzfT5gLFxuICAgIGA8aGVhZD5gLFxuICAgIGA8bWV0YSBjaGFyc2V0PVwidXRmLThcIiAvPmAsXG4gICAgYDx0aXRsZT4ke3NhZmVUaXRsZX08L3RpdGxlPmAsXG4gICAgYCR7YnVuZGxlU3BsaXR0aW5nQm9vdHN0cmFwfSR7c2FmZUhlYWR9YCxcbiAgICBgPC9oZWFkPmAsXG4gICAgYDxib2R5JHtzYWZlQm9keUF0dHJzfT4ke2N0eC5yZW5kZXJlZH0ke3NhZmVCb2R5fTwvYm9keT5gLFxuICAgICc8L2h0bWw+JyxcbiAgXS5qb2luKCcnKTtcbn1cblxuZnVuY3Rpb24gZ2V0Q29yZUdsb2JhbHMoY3R4KSB7XG4gIGNvbnN0IHt3ZWJwYWNrUHVibGljUGF0aCwgbm9uY2V9ID0gY3R4O1xuXG4gIHJldHVybiBbXG4gICAgYDxzY3JpcHQgbm9uY2U9XCIke25vbmNlfVwiPmAsXG4gICAgYHdpbmRvdy5wZXJmb3JtYW5jZSAmJiB3aW5kb3cucGVyZm9ybWFuY2UubWFyayAmJiB3aW5kb3cucGVyZm9ybWFuY2UubWFyaygnZmlyc3RSZW5kZXJTdGFydCcpO2AsXG4gICAgYF9fUk9VVEVfUFJFRklYX18gPSAke0pTT04uc3RyaW5naWZ5KGN0eC5wcmVmaXgpfTtgLCAvLyBjb25zdW1lZCBieSAuL2NsaWVudFxuICAgIGBfX1dFQlBBQ0tfUFVCTElDX1BBVEhfXyA9ICR7SlNPTi5zdHJpbmdpZnkod2VicGFja1B1YmxpY1BhdGgpfTtgLCAvLyBjb25zdW1lZCBieSBmdXNpb24tY2xpZW50cmllcy9jbGllbnQtZW50cnlcbiAgICBgPC9zY3JpcHQ+YCxcbiAgXS5qb2luKCcnKTtcbn1cblxuZnVuY3Rpb24gZ2V0VXJscyh7Y2h1bmtVcmxNYXAsIHdlYnBhY2tQdWJsaWNQYXRofSwgY2h1bmtzKSB7XG4gIC8vIGNyb3NzIG9yaWdpbiBpcyBuZWVkZWQgdG8gZ2V0IG1lYW5pbmdmdWwgZXJyb3JzIGluIHdpbmRvdy5vbmVycm9yXG4gIGNvbnN0IGlzQ3Jvc3NPcmlnaW4gPSB3ZWJwYWNrUHVibGljUGF0aC5zdGFydHNXaXRoKCdodHRwJyk7XG4gIGNvbnN0IGNyb3NzT3JpZ2luQXR0cmlidXRlID0gaXNDcm9zc09yaWdpbiA/ICcgY3Jvc3NvcmlnaW49XCJhbm9ueW1vdXNcIicgOiAnJztcbiAgcmV0dXJuIFsuLi5uZXcgU2V0KGNodW5rcyldLm1hcCgoaWQpID0+IHtcbiAgICBsZXQgdXJsID0gY2h1bmtVcmxNYXAuZ2V0KGlkKS5nZXQoJ2VzNScpO1xuICAgIGlmICh3ZWJwYWNrUHVibGljUGF0aC5lbmRzV2l0aCgnLycpKSB7XG4gICAgICB1cmwgPSB3ZWJwYWNrUHVibGljUGF0aCArIHVybDtcbiAgICB9IGVsc2Uge1xuICAgICAgdXJsID0gd2VicGFja1B1YmxpY1BhdGggKyAnLycgKyB1cmw7XG4gICAgfVxuICAgIHJldHVybiB7dXJsLCBjcm9zc09yaWdpbkF0dHJpYnV0ZX07XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRDaHVua1NjcmlwdHMoY3R4KSB7XG4gIGNvbnN0IHN5bmMgPSBnZXRVcmxzKGN0eCwgY3R4LnN5bmNDaHVua3MpLm1hcChcbiAgICAoe3VybCwgY3Jvc3NPcmlnaW5BdHRyaWJ1dGV9KSA9PiB7XG4gICAgICByZXR1cm4gYDxzY3JpcHQgbm9uY2U9XCIke2N0eC5ub25jZX1cIiBkZWZlciR7Y3Jvc3NPcmlnaW5BdHRyaWJ1dGV9IHNyYz1cIiR7dXJsfVwiPjwvc2NyaXB0PmA7XG4gICAgfVxuICApO1xuICBjb25zdCBwcmVsb2FkZWQgPSBnZXRVcmxzKFxuICAgIGN0eCxcbiAgICBjdHgucHJlbG9hZENodW5rcy5maWx0ZXIoKGl0ZW0pID0+ICFjdHguc3luY0NodW5rcy5pbmNsdWRlcyhpdGVtKSlcbiAgKS5tYXAoKHt1cmwsIGNyb3NzT3JpZ2luQXR0cmlidXRlfSkgPT4ge1xuICAgIHJldHVybiBgPHNjcmlwdCBub25jZT1cIiR7Y3R4Lm5vbmNlfVwiIGRlZmVyJHtjcm9zc09yaWdpbkF0dHJpYnV0ZX0gc3JjPVwiJHt1cmx9XCI+PC9zY3JpcHQ+YDtcbiAgfSk7XG4gIHJldHVybiBbLi4ucHJlbG9hZGVkLCAuLi5zeW5jXS5qb2luKCcnKTtcbn1cblxuZnVuY3Rpb24gZ2V0UHJlbG9hZEhpbnRMaW5rcyhjdHgpIHtcbiAgY29uc3QgY2h1bmtzID0gWy4uLmN0eC5wcmVsb2FkQ2h1bmtzLCAuLi5jdHguc3luY0NodW5rc107XG4gIGNvbnN0IGhpbnRzID0gZ2V0VXJscyhjdHgsIGNodW5rcykubWFwKCh7dXJsLCBjcm9zc09yaWdpbkF0dHJpYnV0ZX0pID0+IHtcbiAgICByZXR1cm4gYDxsaW5rIHJlbD1cInByZWxvYWRcIiR7Y3Jvc3NPcmlnaW5BdHRyaWJ1dGV9IGhyZWY9XCIke3VybH1cIiBub25jZT1cIiR7Y3R4Lm5vbmNlfVwiIGFzPVwic2NyaXB0XCIgLz5gO1xuICB9KTtcbiAgcmV0dXJuIGhpbnRzLmpvaW4oJycpO1xufVxuXG5mdW5jdGlvbiBnZXRTZXJpYWxpemVkVW5pdmVyc2FsVmFsdWVzKGN0eCkge1xuICBjb25zdCBhcHAgPSBjdHhbYXBwU3ltYm9sXTtcbiAgcmV0dXJuIGh0bWxgPHNjcmlwdCB0eXBlPVwiYXBwbGljYXRpb24vanNvblwiIGlkPVwiX19GVVNJT05fVU5JVkVSU0FMX1ZBTFVFU19fXCI+XG4gICAgJHtKU09OLnN0cmluZ2lmeSh7Li4uYXBwLnVuaXZlcnNhbFZhbHVlcywgLi4uY3R4LnVuaXZlcnNhbFZhbHVlc30pfVxuICA8L3NjcmlwdD5gO1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFhQSxNQUFNQSxVQUFVLEdBQUcsSUFBQUMsMEJBQVksRUFBQztFQUM5QkMsSUFBSSxFQUFFO0lBQ0pDLHFCQUFxQixFQUFFQywyQ0FBbUMsQ0FBQ0M7RUFDN0QsQ0FBQztFQUNEQyxRQUFRLEVBQUdKLElBQUksSUFBd0I7SUFDckMsT0FBUUssR0FBRyxJQUFLO01BQ2Q7TUFDQTtNQUNBLElBQUlBLEdBQUcsQ0FBQ0MsSUFBSSxDQUFDQyxLQUFLLENBQUMsMENBQTBDLENBQUMsRUFDNUQsT0FBTyxLQUFLO01BRWQsSUFBSSxJQUFBQyxZQUFLLEVBQUNILEdBQUcsQ0FBQyxFQUFFO1FBQ2QsT0FBTyxJQUFJO01BQ2I7O01BRUE7TUFDQTtNQUNBO01BQ0EsSUFBSSxDQUFDQSxHQUFHLENBQUNJLE9BQU8sQ0FBQ0MsTUFBTSxFQUFFLE9BQU8sS0FBSztNQUNyQyxJQUFJLENBQUNMLEdBQUcsQ0FBQ0ksT0FBTyxDQUFDQyxNQUFNLENBQUNDLFFBQVEsQ0FBQyxXQUFXLENBQUMsRUFBRSxPQUFPLEtBQUs7TUFFM0QsT0FBT1gsSUFBSSxDQUFDQyxxQkFBcUIsR0FBRyxRQUFRLEdBQUcsSUFBSTtJQUNyRCxDQUFDO0VBQ0g7QUFDRixDQUFDLENBQUM7QUFBQztB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
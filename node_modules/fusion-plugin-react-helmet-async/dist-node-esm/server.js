/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

import React from 'react';
import { createPlugin, dangerouslySetHTML } from 'fusion-core';
import { HelmetProvider } from 'react-helmet-async';
import { jsx as _jsx } from "react/jsx-runtime";
const keys = ['meta', 'link', 'style', 'base', 'noscript', 'script'];
const plugin = true && createPlugin({
  middleware: () => {
    return async (ctx, next) => {
      if (!ctx.element) {
        return next();
      }
      const helmetContext = {};
      ctx.element = /*#__PURE__*/_jsx(HelmetProvider, {
        context: helmetContext,
        children: ctx.element
      });
      await next();
      const {
        helmet
      } = helmetContext;
      if (helmet) {
        ctx.template.title = dangerouslySetHTML(helmet.title.toString().replace('</title>', '').replace(/^<title.*>/, ''));
        keys.forEach(key => {
          ctx.template.head.push(dangerouslySetHTML(helmet[key].toString()));
        });
        Object.assign(ctx.template.htmlAttrs, helmet.htmlAttributes.toComponent());
      }
    };
  }
});
export default plugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZWFjdCIsImNyZWF0ZVBsdWdpbiIsImRhbmdlcm91c2x5U2V0SFRNTCIsIkhlbG1ldFByb3ZpZGVyIiwia2V5cyIsInBsdWdpbiIsIm1pZGRsZXdhcmUiLCJjdHgiLCJuZXh0IiwiZWxlbWVudCIsImhlbG1ldENvbnRleHQiLCJoZWxtZXQiLCJ0ZW1wbGF0ZSIsInRpdGxlIiwidG9TdHJpbmciLCJyZXBsYWNlIiwiZm9yRWFjaCIsImtleSIsImhlYWQiLCJwdXNoIiwiT2JqZWN0IiwiYXNzaWduIiwiaHRtbEF0dHJzIiwiaHRtbEF0dHJpYnV0ZXMiLCJ0b0NvbXBvbmVudCJdLCJzb3VyY2VzIjpbInNyYy9zZXJ2ZXIudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBDb3B5cmlnaHQgKGMpIDIwMTggVWJlciBUZWNobm9sb2dpZXMsIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKi9cblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7Y3JlYXRlUGx1Z2luLCBkYW5nZXJvdXNseVNldEhUTUx9IGZyb20gJ2Z1c2lvbi1jb3JlJztcbmltcG9ydCB7SGVsbWV0UHJvdmlkZXJ9IGZyb20gJ3JlYWN0LWhlbG1ldC1hc3luYyc7XG5cbmltcG9ydCB0eXBlIHtGdXNpb25QbHVnaW59IGZyb20gJ2Z1c2lvbi1jb3JlJztcblxuY29uc3Qga2V5cyA9IFsnbWV0YScsICdsaW5rJywgJ3N0eWxlJywgJ2Jhc2UnLCAnbm9zY3JpcHQnLCAnc2NyaXB0J107XG5cbmNvbnN0IHBsdWdpbiA9XG4gIF9fTk9ERV9fICYmXG4gIGNyZWF0ZVBsdWdpbih7XG4gICAgbWlkZGxld2FyZTogKCkgPT4ge1xuICAgICAgcmV0dXJuIGFzeW5jIChjdHgsIG5leHQpID0+IHtcbiAgICAgICAgaWYgKCFjdHguZWxlbWVudCkge1xuICAgICAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGVsbWV0Q29udGV4dDogYW55ID0ge307XG4gICAgICAgIGN0eC5lbGVtZW50ID0gKFxuICAgICAgICAgIDxIZWxtZXRQcm92aWRlciBjb250ZXh0PXtoZWxtZXRDb250ZXh0fT57Y3R4LmVsZW1lbnR9PC9IZWxtZXRQcm92aWRlcj5cbiAgICAgICAgKTtcbiAgICAgICAgYXdhaXQgbmV4dCgpO1xuICAgICAgICBjb25zdCB7aGVsbWV0fSA9IGhlbG1ldENvbnRleHQ7XG4gICAgICAgIGlmIChoZWxtZXQpIHtcbiAgICAgICAgICBjdHgudGVtcGxhdGUudGl0bGUgPSBkYW5nZXJvdXNseVNldEhUTUwoXG4gICAgICAgICAgICBoZWxtZXQudGl0bGVcbiAgICAgICAgICAgICAgLnRvU3RyaW5nKClcbiAgICAgICAgICAgICAgLnJlcGxhY2UoJzwvdGl0bGU+JywgJycpXG4gICAgICAgICAgICAgIC5yZXBsYWNlKC9ePHRpdGxlLio+LywgJycpXG4gICAgICAgICAgKTtcbiAgICAgICAgICBrZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAgICAgY3R4LnRlbXBsYXRlLmhlYWQucHVzaChkYW5nZXJvdXNseVNldEhUTUwoaGVsbWV0W2tleV0udG9TdHJpbmcoKSkpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAgICBjdHgudGVtcGxhdGUuaHRtbEF0dHJzLFxuICAgICAgICAgICAgaGVsbWV0Lmh0bWxBdHRyaWJ1dGVzLnRvQ29tcG9uZW50KClcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sXG4gIH0pO1xuXG5leHBvcnQgZGVmYXVsdCBwbHVnaW4gYXMgYW55IGFzIEZ1c2lvblBsdWdpbjx1bmRlZmluZWQsIHVuZGVmaW5lZD47XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxLQUFLLE1BQU0sT0FBTztBQUN6QixTQUFRQyxZQUFZLEVBQUVDLGtCQUFrQixRQUFPLGFBQWE7QUFDNUQsU0FBUUMsY0FBYyxRQUFPLG9CQUFvQjtBQUFDO0FBSWxELE1BQU1DLElBQUksR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDO0FBRXBFLE1BQU1DLE1BQU0sR0FDVixRQUNBSixZQUFZLENBQUM7RUFDWEssVUFBVSxFQUFFLE1BQU07SUFDaEIsT0FBTyxPQUFPQyxHQUFHLEVBQUVDLElBQUksS0FBSztNQUMxQixJQUFJLENBQUNELEdBQUcsQ0FBQ0UsT0FBTyxFQUFFO1FBQ2hCLE9BQU9ELElBQUksRUFBRTtNQUNmO01BQ0EsTUFBTUUsYUFBa0IsR0FBRyxDQUFDLENBQUM7TUFDN0JILEdBQUcsQ0FBQ0UsT0FBTyxnQkFDVCxLQUFDLGNBQWM7UUFBQyxPQUFPLEVBQUVDLGFBQWM7UUFBQSxVQUFFSCxHQUFHLENBQUNFO01BQU8sRUFDckQ7TUFDRCxNQUFNRCxJQUFJLEVBQUU7TUFDWixNQUFNO1FBQUNHO01BQU0sQ0FBQyxHQUFHRCxhQUFhO01BQzlCLElBQUlDLE1BQU0sRUFBRTtRQUNWSixHQUFHLENBQUNLLFFBQVEsQ0FBQ0MsS0FBSyxHQUFHWCxrQkFBa0IsQ0FDckNTLE1BQU0sQ0FBQ0UsS0FBSyxDQUNUQyxRQUFRLEVBQUUsQ0FDVkMsT0FBTyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FDdkJBLE9BQU8sQ0FBQyxZQUFZLEVBQUUsRUFBRSxDQUFDLENBQzdCO1FBQ0RYLElBQUksQ0FBQ1ksT0FBTyxDQUFFQyxHQUFHLElBQUs7VUFDcEJWLEdBQUcsQ0FBQ0ssUUFBUSxDQUFDTSxJQUFJLENBQUNDLElBQUksQ0FBQ2pCLGtCQUFrQixDQUFDUyxNQUFNLENBQUNNLEdBQUcsQ0FBQyxDQUFDSCxRQUFRLEVBQUUsQ0FBQyxDQUFDO1FBQ3BFLENBQUMsQ0FBQztRQUNGTSxNQUFNLENBQUNDLE1BQU0sQ0FDWGQsR0FBRyxDQUFDSyxRQUFRLENBQUNVLFNBQVMsRUFDdEJYLE1BQU0sQ0FBQ1ksY0FBYyxDQUFDQyxXQUFXLEVBQUUsQ0FDcEM7TUFDSDtJQUNGLENBQUM7RUFDSDtBQUNGLENBQUMsQ0FBQztBQUVKLGVBQWVuQixNQUFNIn0=
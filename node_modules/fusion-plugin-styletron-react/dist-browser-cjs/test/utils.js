"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getComputedStyle = getComputedStyle;
exports.getStyles = getStyles;
exports.untilReady = untilReady;
/* eslint-env node, browser */

function getStyles(page) {
  return page.evaluate(() => {
    return Array.from(document.styleSheets).flatMap(sheet => Array.from(sheet.cssRules).flatMap(rule => rule.cssText));
  });
}
function getComputedStyle(page, selector) {
  return page.$eval(selector, el => JSON.parse(JSON.stringify(getComputedStyle(el))));
}
async function untilReady(page, port) {
  let started = false;
  let numTries = 0;
  while (!started && numTries < 10) {
    try {
      await page.goto(`http://localhost:${port}`);
      started = true;
    } catch (e) {
      numTries++;
      await new Promise(resolve => {
        setTimeout(resolve, Math.pow(2, numTries));
      });
    }
  }
  if (!started) {
    throw new Error('Failed to start');
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRTdHlsZXMiLCJwYWdlIiwiZXZhbHVhdGUiLCJBcnJheSIsImZyb20iLCJkb2N1bWVudCIsInN0eWxlU2hlZXRzIiwiZmxhdE1hcCIsInNoZWV0IiwiY3NzUnVsZXMiLCJydWxlIiwiY3NzVGV4dCIsImdldENvbXB1dGVkU3R5bGUiLCJzZWxlY3RvciIsIiRldmFsIiwiZWwiLCJKU09OIiwicGFyc2UiLCJzdHJpbmdpZnkiLCJ1bnRpbFJlYWR5IiwicG9ydCIsInN0YXJ0ZWQiLCJudW1UcmllcyIsImdvdG8iLCJlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiTWF0aCIsInBvdyIsIkVycm9yIl0sInNvdXJjZXMiOlsic3JjL3Rlc3QvdXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWVudiBub2RlLCBicm93c2VyICovXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdHlsZXMocGFnZSkge1xuICByZXR1cm4gcGFnZS5ldmFsdWF0ZSgoKSA9PiB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oZG9jdW1lbnQuc3R5bGVTaGVldHMpLmZsYXRNYXAoKHNoZWV0KSA9PlxuICAgICAgQXJyYXkuZnJvbShzaGVldC5jc3NSdWxlcykuZmxhdE1hcCgocnVsZSkgPT4gcnVsZS5jc3NUZXh0KVxuICAgICk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29tcHV0ZWRTdHlsZShwYWdlLCBzZWxlY3Rvcj8pIHtcbiAgcmV0dXJuIHBhZ2UuJGV2YWwoc2VsZWN0b3IsIChlbCkgPT5cbiAgICBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGdldENvbXB1dGVkU3R5bGUoZWwpKSlcbiAgKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVudGlsUmVhZHkocGFnZSwgcG9ydCkge1xuICBsZXQgc3RhcnRlZCA9IGZhbHNlO1xuICBsZXQgbnVtVHJpZXMgPSAwO1xuICB3aGlsZSAoIXN0YXJ0ZWQgJiYgbnVtVHJpZXMgPCAxMCkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBwYWdlLmdvdG8oYGh0dHA6Ly9sb2NhbGhvc3Q6JHtwb3J0fWApO1xuICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbnVtVHJpZXMrKztcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgTWF0aC5wb3coMiwgbnVtVHJpZXMpKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGlmICghc3RhcnRlZCkge1xuICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHN0YXJ0Jyk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7QUFFTyxTQUFTQSxTQUFTLENBQUNDLElBQUksRUFBRTtFQUM5QixPQUFPQSxJQUFJLENBQUNDLFFBQVEsQ0FBQyxNQUFNO0lBQ3pCLE9BQU9DLEtBQUssQ0FBQ0MsSUFBSSxDQUFDQyxRQUFRLENBQUNDLFdBQVcsQ0FBQyxDQUFDQyxPQUFPLENBQUVDLEtBQUssSUFDcERMLEtBQUssQ0FBQ0MsSUFBSSxDQUFDSSxLQUFLLENBQUNDLFFBQVEsQ0FBQyxDQUFDRixPQUFPLENBQUVHLElBQUksSUFBS0EsSUFBSSxDQUFDQyxPQUFPLENBQUMsQ0FDM0Q7RUFDSCxDQUFDLENBQUM7QUFDSjtBQUVPLFNBQVNDLGdCQUFnQixDQUFDWCxJQUFJLEVBQUVZLFFBQVMsRUFBRTtFQUNoRCxPQUFPWixJQUFJLENBQUNhLEtBQUssQ0FBQ0QsUUFBUSxFQUFHRSxFQUFFLElBQzdCQyxJQUFJLENBQUNDLEtBQUssQ0FBQ0QsSUFBSSxDQUFDRSxTQUFTLENBQUNOLGdCQUFnQixDQUFDRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQ2pEO0FBQ0g7QUFFTyxlQUFlSSxVQUFVLENBQUNsQixJQUFJLEVBQUVtQixJQUFJLEVBQUU7RUFDM0MsSUFBSUMsT0FBTyxHQUFHLEtBQUs7RUFDbkIsSUFBSUMsUUFBUSxHQUFHLENBQUM7RUFDaEIsT0FBTyxDQUFDRCxPQUFPLElBQUlDLFFBQVEsR0FBRyxFQUFFLEVBQUU7SUFDaEMsSUFBSTtNQUNGLE1BQU1yQixJQUFJLENBQUNzQixJQUFJLENBQUUsb0JBQW1CSCxJQUFLLEVBQUMsQ0FBQztNQUMzQ0MsT0FBTyxHQUFHLElBQUk7SUFDaEIsQ0FBQyxDQUFDLE9BQU9HLENBQUMsRUFBRTtNQUNWRixRQUFRLEVBQUU7TUFDVixNQUFNLElBQUlHLE9BQU8sQ0FBRUMsT0FBTyxJQUFLO1FBQzdCQyxVQUFVLENBQUNELE9BQU8sRUFBRUUsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQyxFQUFFUCxRQUFRLENBQUMsQ0FBQztNQUM1QyxDQUFDLENBQUM7SUFDSjtFQUNGO0VBRUEsSUFBSSxDQUFDRCxPQUFPLEVBQUU7SUFDWixNQUFNLElBQUlTLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQztFQUNwQztBQUNGIn0=